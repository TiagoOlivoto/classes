geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.01, 1))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.01, 10))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.01, 3))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.01, 2))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 2))) +
theme_bw() +
theme(panel.grid = element_blank())
# low variance
set.seed()
# low variance
set.seed()
df <-
data.frame(g1 = rnorm(20, 10, 0.5),
g2 = rnorm(20, 13, 0.4),
g3 = rnorm(20, 18, 0.4)) |>
pivot_longer(cols = everything())
parms <-
df |>
group_by(name) |>
summarise(mu = mean(value),
sd = sd(value))
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 2))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 2,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 2,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 1))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 2,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 1))) +
theme_bw() +
theme(panel.grid = element_blank())
df <-
data.frame(g1 = rnorm(20, 10, 3),
g2 = rnorm(20, 13, 2),
g3 = rnorm(20, 18, 2)) |>
pivot_longer(cols = everything())
parms <-
df |>
group_by(name) |>
summarise(mu = mean(value),
sd = sd(value))
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 1))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.5))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.3))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.2))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(df, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.25))) +
theme_bw() +
theme(panel.grid = element_blank())
#| out-width: "100%"
#| code-fold: true
#| code-summary: "Mostrar código"
library(ggplot2)
df1 <- 4
df2 <- 20
(ftab <- qf(0.05, df1, df2, lower.tail = FALSE))
ggplot() +
scale_x_continuous(limits = c(0,  6),
breaks = c(0,  2, ftab, 4, 6)) +
stat_function(fun = df,
geom = "area",
fill = "forestgreen",
xlim = c(ftab, 6),
args = list(
df1 = df1,
df2 = df2
)) +
stat_function(fun = df,
geom = "line",
size = 1,
args = list(
df1 = df1,
df2 = df2
)) +
theme_bw(base_size = 16) +
theme(panel.grid.minor = element_blank()) +
scale_y_continuous(expand = expansion(mult = c(0, .1)))+
labs(x = "Valor de F",
y = "Probabilidade acumulada",
title = "Distribuição F (DF1: 4, DF2: 20)")
df1
df2
ggplot() +
scale_x_continuous(limits = c(0,  6),
breaks = c(0,  2, ftab, 4, 6)) +
stat_function(fun = df,
geom = "area",
fill = "forestgreen",
xlim = c(ftab, 6),
args = list(
df1 = df1,
df2 = df2
))
df
#| code-fold: true
#| out-width: "100%"
#| message: false
#| warning: false
library(tidyverse)
set.seed(1)
dados <-
data.frame(g1 = rnorm(20, 10, 3),
g2 = rnorm(20, 13, 2),
g3 = rnorm(20, 18, 2)) |>
pivot_longer(cols = everything())
parms <-
dados |>
group_by(name) |>
summarise(mu = mean(value),
sd = sd(value))
ggplot(dados, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(df$value), sd = sd(df$value))) +
geom_vline(xintercept = mean(df$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.25))) +
theme_bw() +
theme(panel.grid = element_blank())
ggplot(dados, aes(value, fill = name)) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g1"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[1], sd = parms$sd[1])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g2"),
size = 1.5,
n = 1000,
args = list(mean = parms$mu[2], sd = parms$sd[2])) +
stat_function(fun=dnorm,
geom="line",
aes(color = "g3"),
size = 2,
n = 1000,
args = list(mean = parms$mu[3], sd = parms$sd[3])) +
stat_function(fun=dnorm,
geom="line",
color = "black",
size = 1.5,
args = list(mean = mean(dados$value), sd = sd(dados$value))) +
geom_vline(xintercept = mean(dados$value)) +
scale_color_manual(values = metan::ggplot_color(4)) +
scale_y_continuous(breaks = NULL, limits = (c(0.001, 0.25))) +
theme_bw() +
theme(panel.grid = element_blank())
