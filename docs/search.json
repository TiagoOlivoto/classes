[
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html",
    "href": "FIT5306/FIT5306_07_DELN.html",
    "title": "7. Análise de Variância",
    "section": "",
    "text": "Tip\n\n\n\n“Muito melhor uma resposta aproximada à pergunta certa, que muitas vezes é vaga, do que uma resposta exata à pergunta errada, que sempre pode ser feita com precisão.” — John Tukey"
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#dic",
    "href": "FIT5306/FIT5306_07_DELN.html#dic",
    "title": "7. Análise de Variância",
    "section": "DIC",
    "text": "DIC\nPara realizar a casualização em um experimento de delineamento inteiramente ao acaso, pode-se utilizar a função sketch do pacote agroR. Neste exemplo, simulo a casualização de quatro tratamentos (“C1”, “C2”, “C3” e “C4”) em um ensaio conduzido em delineamento inteiramente casualizado (DIC) com quatro repetições (r).\n\nlibrary(AgroR)\n\nWarning: package 'AgroR' was built under R version 4.2.1\n\n\n\nAttaching package: 'AgroR'\n\n\nThe following object is masked from 'package:dplyr':\n\n    desc\n\nset.seed(1)\ntrats <- c(\"C1\", \"C2\", \"C3\", \"C4\")\nsketch(trats, r = 4)"
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#dbc",
    "href": "FIT5306/FIT5306_07_DELN.html#dbc",
    "title": "7. Análise de Variância",
    "section": "DBC",
    "text": "DBC\nPara casualização em DBC, a mesma função sketch é usada. No entanto, utiliza-se o argumento design para indicar que o delineamento é um DBC\n\nset.seed(1)\ntrats <- c(\"C1\", \"C2\", \"C3\", \"C4\")\n# casualização em DBC\nsketch(trats, r = 4, design = \"DBC\")\n\n\n\n# inverte a posição dos blocos\nsketch(trats, r = 4, design = \"DBC\", pos = \"column\")"
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#exemplo-de-aplicação",
    "href": "FIT5306/FIT5306_07_DELN.html#exemplo-de-aplicação",
    "title": "7. Análise de Variância",
    "section": "Exemplo de aplicação",
    "text": "Exemplo de aplicação\nNa figura abaixo é mostrado como o DBC pode ser utilizado para considerar fontes de variação conhecida na área experimental. Neste caso, um gradiente de fósforo conhecido é notado no solo, onde maiores valores são observados na parte inferior e menores na parte inferior. Assim, os blocos podem ser alocados de modo que cada tratamento seja casualizado dentro de grupos de unidades experimentais homogêneas (blocos).\n\n\n\nExemplo de casualização em DBC"
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#dados",
    "href": "FIT5306/FIT5306_07_DELN.html#dados",
    "title": "7. Análise de Variância",
    "section": "Dados",
    "text": "Dados\nOs dados utilizados neste exemplo estão na planilha QUALI do conjunto de dados data_R.xlsx. Os próximos códigos carregam o conjunto de dados e criam um gráfico do tipo boxplot para explorar o padrão dos dados.\n\nlibrary(tidyverse)\nlibrary(metan)\nlibrary(rio)\nlibrary(AgroR)\n\nurl <- \"http://bit.ly/df_biostat\"\ndf <- import(url, sheet = \"QUALI\")\nstr(df)\n\n'data.frame':   20 obs. of  3 variables:\n $ BLOCO  : num  1 1 1 1 1 2 2 2 2 2 ...\n $ HIBRIDO: chr  \"NP_1\" \"NP_2\" \"NP_3\" \"NP_4\" ...\n $ RG     : num  8.82 9.12 7.74 6.48 4.06 ...\n\np1 <-\n  ggplot(df, aes(HIBRIDO, RG))+\n  geom_hline(yintercept = mean(df$RG), linetype = \"dashed\")+\n  geom_boxplot()+\n  stat_summary(geom = \"point\", fun = mean, shape = 23) +\n  stat_summary(aes(label = round(after_stat(y), 2),\n                   x = HIBRIDO), \n               fun=mean,\n               geom=\"text\",\n               hjust=-0.3)\n\np2 <- \n  ggplot(df, aes(factor(BLOCO), RG))+\n  geom_hline(yintercept = mean(df$RG), linetype = \"dashed\")+\n  geom_boxplot()+\n  stat_summary(geom = \"point\", fun = mean, shape = 23) +\n  stat_summary(aes(label = round(after_stat(y), 2),\n                   x = BLOCO), \n               fun=mean,\n               geom=\"text\",\n               hjust=-0.3)\n\np1 + p2\n\n\n\n\nAnalizando o boxplot acima é razoável dizer que as médias dos tratamentos são diferentes, principalmente comparando o NP_1 com NP_5. Esta suspeita de diferença, no entanto, deve ser suportada com a realização da análise de variância."
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#anova-em-dic",
    "href": "FIT5306/FIT5306_07_DELN.html#anova-em-dic",
    "title": "7. Análise de Variância",
    "section": "Anova em DIC",
    "text": "Anova em DIC\nNo pacote AgroR, quando os fatores são qualitativos, a análise complementar aplicada é a comparção de médias. A função DIC() do pacote retorna a tabela da ANOVA, a análise de pressupostos (normalidade e homogeneidade) e o teste de comparação de médias.\n\nmod_dic <- with(df, DIC(HIBRIDO, RG))\n\n\n\n\n\n-----------------------------------------------------------------\nNormality of errors\n-----------------------------------------------------------------\n                         Method Statistic     p.value\n Shapiro-Wilk normality test(W)  0.827455 0.002285375\n\n\n-----------------------------------------------------------------\nHomogeneity of Variances\n-----------------------------------------------------------------\n                              Method Statistic   p.value\n Bartlett test(Bartlett's K-squared) 0.9557917 0.9164237\n\n\n-----------------------------------------------------------------\nIndependence from errors\n-----------------------------------------------------------------\n                 Method Statistic      p.value\n Durbin-Watson test(DW) 0.3899192 3.318679e-05\n\n\n-----------------------------------------------------------------\nAdditional Information\n-----------------------------------------------------------------\n\nCV (%) =  23.06\nMStrat/MST =  0.69\nMean =  8.2479\nMedian =  8.0515\nPossible outliers =  No discrepant point\n\n-----------------------------------------------------------------\nAnalysis of Variance\n-----------------------------------------------------------------\n          Df   Sum Sq  Mean.Sq  F value     Pr(F)\ntrat       4 32.62995 8.157488 2.254327 0.1117755\nResiduals 15 54.27888 3.618592                   \n\n\n\n\n-----------------------------------------------------------------\nMultiple Comparison Test\n-----------------------------------------------------------------\n[1] \"H0 is not rejected\"\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nAs funções do pacote AgroR utilizam os dados “anexados” ao ambiente de trabalho, ou seja, um argumento data = . não existe para suas funções. Note que no exemplo acima foi utilizado a função with(qualitativo, DIC(...)). Isto permite acessar variáveis presentes no data frame. Uma outra maneira de realizar esta mesma análise é utilizando a função attach(df), qual carregará o data frame no ambiente R, assim é possível utilizar a função DIC(...). Após realizada a análise, é recomendado executar o comando detach(df) para “limpar” os dados do ambiente de trabalho.\n\n\nA interpretação da significância, ou seja, se as médias de produtividade dos híbridos foram significativamente diferentes a uma determinada probabilidade de erro é feita verificando-se o valor de \"Pr>fc\" na ANOVA. A figura abaixo mostra a distribuição F considerando os graus de liberdade de tratamento e erro \\(F_{4, 15}\\) e nos ajuda a compreender um pouco melhor isto.\n\n\nVeja o código que gerou o gráfico\ndf1 <- 4\ndf2 <- 15\nfcal <- 2.2543\nftab <- 3.055\n\nggplot() +\n  scale_x_continuous(limits = c(0,  6),\n                     breaks = c(0,  fcal, ftab,  6)) +\n  stat_function(fun = df,\n                geom = \"area\",\n                fill = \"red\",\n                xlim = c(fcal, 6),\n                args = list(\n                  df1 = df1,\n                  df2 = 63\n                )) +\n  stat_function(fun = df,\n                geom = \"area\",\n                fill = \"forestgreen\",\n                xlim = c(ftab, 6),\n                args = list(\n                  df1 = df1,\n                  df2 = 63\n                )) +\n  stat_function(fun = df,\n                geom = \"line\",\n                size = 1,\n                args = list(\n                  df1 = df1,\n                  df2 = 63\n                )) +\n  theme_bw(base_size = 16) +\n  theme(panel.grid.minor = element_blank()) +\n  scale_y_continuous(expand = expansion(mult = c(0, .1)))+\n  labs(x = \"Valor de F\",\n       y = \"Probabilidade acumulada\",\n       title = \"Distribuição F (DF1: 4, DF2: 15)\")\n\n\n\n\n\nDistribuição F com DF1 = 1 e DF2 = 15\n\n\nO valor de F calculado em nosso exemplo foi de 2,2543, o que resulta em uma probabilidade de erro acumulada de 0,1117 (11,17%). Esta probabilidade de erro acumulada está representada pela cor vermelha. Logo, não rejeitou-se a hipótese Para que uma diferença significativa a 5% de probabilidade de erro tivesse sido observada, o valor de F calculado deveria ter sido 3,055 qf(0.05, 4, 15, lower.tail = FALSE), representado neste caso pela cor verde no gráfico.\nConsiderando nosso exemplo, parece razoável dizer que 9,48 t (NP_1) é uma produção maior que 6,28 t (NP_5). Então, é justo perguntar: O que pode ter acontecido para que as médias não tenham sido consideradas diferentes considerando a probabilidade de erro, mesmo tendo fortes indícios de que elas seriam? A primeira opção que nos vem a mente –e que na maioria das vezes é encontrada em artigos científicos– é que as alterações no rendimento de grão observadas fora resultado do acaso; ou seja, neste caso, há a probabilidade de 11,17% de que uma diferença pelo menos tão grande quanto a observada no estudo possa ser gerada a partir de amostras aleatórias se os tratamentos não aferatem a variável resposta. Logo, a recomendação estatística neste caso, seria por optar por qualquer um dos tratamentos. Do ponto de vista prático, sabemos que esta recomendação está totalmente equivocada. Neste ponto surge uma importante (e polêmica) questão: a interpretação do p-valor. Um p-valor de 0,05 não significa que há uma chance de 95% de que determinada hipótese esteja correta. Em vez disso, significa que se a hipótese nula for verdadeira e todas as outras suposições feitas forem válidas, haverá 5% de chance que diferenças ao menos tão grandes quanto as observadas podem ser obtidas de amostras aleatórias. É preciso ter em mente que o p-valor relatado pelos testes é um significado probabilístico, não biológico. Assim, em experimentos biológicos, a interpretação desta estatística deve ser cautelosa, pois um p-valor pode não indicar a importância de uma descoberta. Por exemplo, um medicamento pode ter um efeito estatisticamente significativo nos níveis de glicose no sangue dos pacientes sem ter um efeito terapêutico. Sugerimos a leitura de cinco interessantes artigos relacionados a este assunto (Altman and Krzywinski 2017; Baker 2016; Singh Chawla 2017; Krzywinski and Altman 2013; Nuzzo 2014).\nEm adição à justificativa anterior (as alterações no rendimento de grão observadas fora resultado do acaso), existem pelo menos mais três razões potenciais para a não regeição da hipótese \\(H_0\\) em nosso exemplo:\n\num experimento mal projetado com poder insuficiente para detectar uma diferença (à 5% de erro) entre as médias;\nos tratamentos foram mal escolhidos e não refletiram adequadamente a hipótese inicial do estudo\no experimento foi indevidamente instalado e conduzido sem supervisão adequada, com baixo controle de qualidade sobre os protocolos de tratamento, coleta e análise de dados.\n\nEsta última opção parece ser a mais razoável aqui. É possivel observar no boxplot para o fator bloco que o bloco 4 parece ter uma média superior aos outros blocos. Sabe-ser que no DIC, toda diferença entre as repetições de um mesmo tratamento comporão o erro experimental. Logo, neste exemplo, a área experimental não era homogênea como se pressupunha na instalação do experimento. Isto ficará claro, posteriormente, ao analisarmos o mesmo conjunto de dados, no entanto considerando um DBC."
  },
  {
    "objectID": "FIT5306/FIT5306_07_DELN.html#anova-em-dbc",
    "href": "FIT5306/FIT5306_07_DELN.html#anova-em-dbc",
    "title": "7. Análise de Variância",
    "section": "Anova em DBC",
    "text": "Anova em DBC\n\nwith(df,\n     DBC(HIBRIDO, BLOCO, RG))\n\n\n-----------------------------------------------------------------\nNormality of errors\n-----------------------------------------------------------------\n                         Method Statistic   p.value\n Shapiro-Wilk normality test(W)  0.987223 0.9920259\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal\n\n\n\n-----------------------------------------------------------------\nHomogeneity of Variances\n-----------------------------------------------------------------\n                              Method Statistic   p.value\n Bartlett test(Bartlett's K-squared)  7.696982 0.1033304\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous\n\n\n\n-----------------------------------------------------------------\nIndependence from errors\n-----------------------------------------------------------------\n                 Method Statistic   p.value\n Durbin-Watson test(DW)  2.565113 0.7271231\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent\n\n\n\n-----------------------------------------------------------------\nAdditional Information\n-----------------------------------------------------------------\n\nCV (%) =  8.2\nMStrat/MST =  0.33\nMean =  8.2479\nMedian =  8.0515\nPossible outliers =  No discrepant point\n\n-----------------------------------------------------------------\nAnalysis of Variance\n-----------------------------------------------------------------\n          Df    Sum Sq    Mean.Sq F value        Pr(F)\ntrat       4 32.629952  8.1574881 17.8475 5.449170e-05\nbloco      3 48.794088 16.2646961 35.5850 2.983658e-06\nResiduals 12  5.484793  0.4570661                     \n\n\nAs the calculated p-value, it is less than the 5% significance level. The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ\n\n\n\n\n\n\n-----------------------------------------------------------------\nMultiple Comparison Test\n-----------------------------------------------------------------\n        resp groups\nNP_2 9.48075      a\nNP_1 9.48000      a\nNP_3 8.75075     ab\nNP_4 7.24500     bc\nNP_5 6.28300      c"
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html",
    "href": "FIT5306/FIT5306_08_DIC.html",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "",
    "text": "library(tidyverse)  # manipulação de dados\nlibrary(metan)      # estatísticas descritivas\nlibrary(rio)        # importação/exportação de dados\nlibrary(emmeans)    # comparação de médias\nlibrary(AgroR)      # casualização e ANOVA"
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#características",
    "href": "FIT5306/FIT5306_08_DIC.html#características",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Características",
    "text": "Características\n\nUtiliza apenas os princípios de repetição e casualização;\nOs tratamentos são alocados nas parcelas de forma inteiramente casual, sem nenhum tipo de bloqueamento.\nExige que o material experimental e a área experimental sejam uniformes. Ele geralmente é mais utilizado em experimentos nos quais as condições experimentais podem ser bastante controladas (por exemplo em laboratórios);"
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#vantagens",
    "href": "FIT5306/FIT5306_08_DIC.html#vantagens",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Vantagens",
    "text": "Vantagens\n\nDelineamento flexível, onde o número de tratamentos e repetições depende apenas da quantidade de parcelas disponíveis na área experimental.\nO número de repetições pode diferir de um tratamento para o outro (experimento não balanceado)\nA análise estatística é simples\nO número de graus de liberdade do erro é o maior possível considerando o número de repetições utilizado."
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#desvantagens",
    "href": "FIT5306/FIT5306_08_DIC.html#desvantagens",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Desvantagens",
    "text": "Desvantagens\n\nExige homogeneidade das condições ambientais\nPode estimar uma variância residual muito alta caso a área experimental apresente heterogeneidade, inflacionando o quadrado médio do erro."
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#modelo-estatístico",
    "href": "FIT5306/FIT5306_08_DIC.html#modelo-estatístico",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Modelo estatístico",
    "text": "Modelo estatístico\nO delineamento inteiramente casualizado (DIC) é um delineamento adequado para áreas uniformes (parcelas são uniformes), onde não há necessidade de controle local (bloqueamento). Neste delineamento, os tratamentos devem ser distribuídos aleatoriamente nas parcelas.\nO modelo do DIC é dado por\n\\[\n{Y_{ij}} = m + {t_i} + {\\varepsilon _{ij}}\n\\]\nOnde m é a média geral do experimento, \\(t_i\\) é o efeito de tratamentos, sendo estimado por \\(\\hat t_i = \\bar Y_{i.} - \\bar Y_{..}\\) com a seguinte restrição: \\(\\sum_i \\hat t_i = 0 ~~~~\\forall_i\\) (leia-se, o somatório dos efeitos de tratamento é zero para todo tratamento \\(i\\)). \\(\\epsilon_{ij}\\) é o erro experimental estimado por \\(\\hat e_{ij} = Y_{ij} - m - \\hat t_i\\) onde \\({e_{ij}}\\sim NID(0,{\\sigma ^2})\\)."
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#análise-de-variância-1",
    "href": "FIT5306/FIT5306_08_DIC.html#análise-de-variância-1",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Análise de variância",
    "text": "Análise de variância\nA análise de variância é computada no software R utilizando a função aov(). Considerando o Delineamento Inteiramente Casualizado (DIC), a única fonte de variação incluída no modelo é tratamento, neste caso, RAD.\n\nanova <- aov(MST ~ RAD, data = df_dic)\nsummary(anova)\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## RAD          2  45.06  22.529   25.22 0.000205 ***\n## Residuals    9   8.04   0.893                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "FIT5306/FIT5306_08_DIC.html#comparação-de-médias",
    "href": "FIT5306/FIT5306_08_DIC.html#comparação-de-médias",
    "title": "8. Delineamento Inteiramente Casualizado",
    "section": "Comparação de médias",
    "text": "Comparação de médias\nEm sequência a ANOVA, quando o efeito de tratamento é significativo, teste de Tukey (5% de erro) pode ser utilizado para comparação das médias. Este teste realiza todas as combinações possíveis entre as médias (por isso o nome comparação múltipla de medias), comparando se a diferença entre duas médias é maior ou menor que uma diferença mínima significativa (DMS). Esta DMS é calculada pela seguinte fórmula \\(DMS = q \\times \\sqrt{QME/r}\\), onde q é um valor tabelado, considerando o número de tratamentos e o GL do erro; QME é o quadrado médio do erro; e r é o número de repetições (ou blocos).\n\n\n\n\n\n\nTip\n\n\n\nA fórmula da DMS descrita acima é utilizada apenas se (e somente se) o número de repetições de todos os tratamentos é igual. Caso algum tratamento apresente um número inferir de repetições, fato comumente observado em experimentos de campo devido a presença de parcelas perdidas, a DMS deste par de médias em específico deve ser corrigida. Geralmente, as análises complementares são realizadas quando a ANOVA indica significância para um determinado fator de variação, no entanto, o teste Tukey pode revelar diferença entre as médias, mesmo quando o teste F não indicar essa diferença. Isto pode ser observado, principalmente quando a probabilidade de erro for muito próxima de 5%, por exemplo, Pr>Fc = 0.0502. A recíproca também é verdadeira. O teste Tukey pode indicar que as médias não diferem, se Pr>Fc = 0.0492, por exemplo.\n\n\nO valor de q pode ser encontrado na seguinte tabela:\n\n\n\n\n\nPara este caso, considerando 3 e 9 como o número de tratamentos e o GL do erro, respectivamente, o valor de q é 3,95, que aplicado na fórmula resulta em \\(DMS = 3,95 \\times \\sqrt{0,893/4}=1,866\\). Logo, a diferença mínima entre duas médias para que estas sejam significativamente diferentes (5% de erro), deve ser de 1,866.\nPodemos realizar a comparação par-a-par utilizando a função pwpm() do pacote emmeans.\n\nmedias <- emmeans(anova, ~ RAD)\npwpm(medias)\n\n        50     70    100\n50  [11.2] 0.0061 0.0002\n70   -2.79 [14.0] 0.0428\n100  -4.72  -1.93 [15.9]\n\nRow and column labels: RAD\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\n\nUma alternativa é o Pairwise P-value plot exibindo todos os P-values em comparações de pares. Cada comparação está associada a um segmento de linha vertical que une as posições de escala das duas médias que estão sendo comparadas e cuja posição horizontal é determinada pelo P-valor dessa comparação. Esta técnica não é indicada quando muitas comparações estão sendo testadas.\n\npwpp(medias)\n\n\n\n\nPairwise P-value plot\n\n\n\n\nOutra maneira de representar comparações graficamente por meio do argumento de comparações em plot.emm(). Nesta abordagem, a avaliação da significância das médias de dois tratamentos é dada pela sobreposição das flechas de cada tratamento. Se dois tratamentos apresentam setas que se sobrepoem (considerando o eixo x), assume-se que estes tratamentos são estatisticamente diferentes um do outro.\n\nplot(medias,\n     CIs = FALSE, # remove os intervalos de confiança das médias\n     comparisons = TRUE) # insere setas para comparação de médias (Tukey)\n\n\n\n\nComparações entre pares de médias com base no teste Tukey"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html",
    "href": "FIT5306/FIT5306_09_DBC.html",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "",
    "text": "library(tidyverse)  # manipulação de dados\nlibrary(metan)      # estatísticas descritivas\nlibrary(rio)        # importação/exportação de dados\nlibrary(emmeans)    # comparação de médias\nlibrary(AgroR)      # casualização e ANOVA\nlibrary(ExpDes.pt)"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#características",
    "href": "FIT5306/FIT5306_09_DBC.html#características",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Características",
    "text": "Características\n\nUtiliza apenas os princípios de repetição e casualização;\nOs tratamentos são alocados nas parcelas de forma inteiramente casual, sem nenhum tipo de bloqueamento.\nExige que o material experimental e a área experimental sejam uniformes. Ele geralmente é mais utilizado em experimentos nos quais as condições experimentais podem ser bastante controladas (por exemplo em laboratórios);"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#vantagens",
    "href": "FIT5306/FIT5306_09_DBC.html#vantagens",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Vantagens",
    "text": "Vantagens\n\nControla as diferenças que ocorrem nas condições ambientais, de um bloco para outro;\nPode haver heterogeneidade conhecida na área, desde que a alocação dos blocos seja feita de forma correta\nA variação entre blocos é isolada, logo, reduzindo a variância residual"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#desvantagens",
    "href": "FIT5306/FIT5306_09_DBC.html#desvantagens",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Desvantagens",
    "text": "Desvantagens\n\nDevido a inclusão de mais uma fonte de variação no modelo, há uma redução nos graus de liberdade do erro.\nComo exige-se homogeneidade dentro dos blocos, o número de tratamentos pode ficar limitado, visto que quanto maior é o bloco, mais difícil manter a sua homogeneidade."
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#casualização",
    "href": "FIT5306/FIT5306_09_DBC.html#casualização",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Casualização",
    "text": "Casualização\nPara realizar a casualização em um experimento em DBC, pode-se utilizar a função sketch do pacote agroR. Neste exemplo, simulo a casualização de três tratamentos em um ensaio conduzido em delineamento de blocos completos casualizados com quatro repetições (r). Apenas para fins didáticos, é apresentada também a casualização em DIC.\n\ntrats <- c(\"50\", \"70\", \"100\")\n\n# casualização em DIC\nset.seed(1)\nsketch(trats, r = 4, pos = \"line\")\n\n\n\n# casualização em DBC\nsketch(trats, r = 4, design = \"DBC\", pos = \"line\")"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#modelo-estatístico",
    "href": "FIT5306/FIT5306_09_DBC.html#modelo-estatístico",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Modelo estatístico",
    "text": "Modelo estatístico\nO modelo do DBC é dado por\n\\[\n{Y_{ij}} = m + {b_j} + {t_i} + {\\varepsilon _{ij}}\n\\]\nOnde \\(m\\) é a média geral do experimento, \\(b_j\\) é o efeito de bloco, \\(t_i\\) é o efeito de tratamentos e \\(\\epsilon_{ij}\\) é o erro experimental."
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#análise-de-variância-1",
    "href": "FIT5306/FIT5306_09_DBC.html#análise-de-variância-1",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Análise de variância",
    "text": "Análise de variância\nA análise de variância é computada no software R utilizando a função aov(). Considerando o Delineamento de Blocos Casualizados (DBC), as duas fontes de variação incluídas no modelo são a de tratamento (RAD) e bloco (REP).\n\nanova <- aov(MST ~ RAD + REP, data = df_dbc)\nsummary(anova)\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## RAD          2  45.06  22.529  138.78 9.47e-06 ***\n## REP          3   7.07   2.356   14.51  0.00371 ** \n## Residuals    6   0.97   0.162                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#comparação-de-médias",
    "href": "FIT5306/FIT5306_09_DBC.html#comparação-de-médias",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Comparação de médias",
    "text": "Comparação de médias\nA análise de variância revelou efeito de tratamento significativo. Nesse caso, segue-se realizando uma análise de comparação múltipla de médias. Podemos realizar a comparação par-a-par utilizando a função pwpm() do pacote emmeans. Neste exemplo, o teste Tukey é utilizado.\n\nmedias_dbc <- emmeans(anova, ~ RAD)\npwpm(medias_dbc)\n\n        50     70    100\n50  [11.2] 0.0002 <.0001\n70   -2.79 [14.0] 0.0012\n100  -4.72  -1.93 [15.9]\n\nRow and column labels: RAD\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\n\nNeste exemplo, utilizaremos a função emmeans para realizar a comparação de médias pelo teste Tukey. Nesta abordagem, a avaliação da significância das médias de dois tratamentos é dada pela sobreposição das flechas de cada tratamento. Se dois tratamentos apresentam setas que se sobrepõem (considerando o eixo x), assume-se que estes tratamentos são estatisticamente diferentes um do outro.\nApenas para fins de comparação, incluirei a comparação de médias considerando o modelo DIC. Observe que a redução da estimativa do erro experimental considerando o delineamento DBC fez com que ficasse mais fácil encontrar diferenças entre os tratamentos.\n\nanova_dic <- aov(MST ~ RAD, data = df_dbc)\nmedias_dic <- emmeans(anova_dic, ~ RAD)\n\nmedias_dbc <- emmeans(anova, ~ RAD)\n\nplot_dic <- \n  plot(medias_dic,\n       xlab = \"Matéria seca total (g)\",\n       ylab = \"Tratamentos\",\n       CIs = FALSE, # remove os intervalos de confiança das médias\n       comparisons = TRUE) # insere setas para comparação de médias (Tukey)\n\nplot_dbc <- \n  plot(medias_dbc,\n       xlab = \"Matéria seca total (g)\",\n       ylab = \"Tratamentos\",\n       CIs = FALSE, # remove os intervalos de confiança das médias\n       comparisons = TRUE) # insere setas para comparação de médias (Tukey)\n\narrange_ggplot(plot_dic,\n               plot_dbc,\n               ncol = 1,\n               tag_levels = \"a\")\n\n\n\n\nComparações entre pares de médias com base no teste Tukey considerando o delineamento inteiramente casualizado (a) e o delineamento de blocos casualizados (b)"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#criação-de-gráficos",
    "href": "FIT5306/FIT5306_09_DBC.html#criação-de-gráficos",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Criação de gráficos",
    "text": "Criação de gráficos\n\nmedias <- \n  plot_bars(df_dbc, RAD, MST,\n            lab.bar = c(\"c\", \"b\", \"a\"))\nmedias2 <- \n  plot_bars(df_dbc, RAD, MST,\n            plot_theme = theme_bw(),\n            lab.bar = c(\"c\", \"b\", \"a\"),\n            values = TRUE,\n            width.bar = 0.6,\n            y.expand = 0.2)\n\narrange_ggplot(medias, medias2, tag_levels = \"a\")"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#pacote-agror",
    "href": "FIT5306/FIT5306_09_DBC.html#pacote-agror",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Pacote AgroR",
    "text": "Pacote AgroR\nNo pacote agroR, a análise de variância neste delineamento pode ser realizada com a função DBC().\n\n\nwith(df_dbc,\n     DBC(RAD, REP, MST))\n\n\n\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9445588 0.5592776\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared) 0.4182676 0.8112867\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  1.521488 0.1169862\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  2.94\n## MStrat/MST =  0.9\n## Mean =  13.7232\n## Median =  13.5946\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df     Sum Sq    Mean.Sq   F value        Pr(F)\n## trat       2 45.0579657 22.5289828 138.78145 9.473392e-06\n## bloco      3  7.0667049  2.3555683  14.51061 3.707071e-03\n## Residuals  6  0.9740055  0.1623343                       \n## \n## \n## -----------------------------------------------------------------\n## Multiple Comparison Test\n## -----------------------------------------------------------------\n##         resp groups\n## 100 15.94093      a\n## 70  14.00834      b\n## 50  11.22022      c"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#dados",
    "href": "FIT5306/FIT5306_09_DBC.html#dados",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "Dados",
    "text": "Dados\n\nurl <- \"https://docs.google.com/spreadsheets/d/1vpVGdIkggRxmdnwrkllHbVA0TIHN85UK/edit#gid=1486281449\"\ndf_maize <-  import(url, dec = \",\")\n\ntabela <- \n  df_maize %>% \n  make_mat(HIBRIDO, BLOCO, RG) %>% \n  row_col_sum()\n\ntabela\n\n             B1     B2    B3     B4 row_sums\nNP_1      8.820  9.360  7.98 11.760   37.920\nNP_2      9.123  7.860  8.82 12.120   37.923\nNP_3      7.740  8.123  7.92 11.220   35.003\nNP_4      6.480  6.720  6.12  9.660   28.980\nNP_5      4.060  5.180  5.90  9.992   25.132\ncol_sums 36.223 37.243 36.74 54.752  164.958"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#r-base",
    "href": "FIT5306/FIT5306_09_DBC.html#r-base",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "R base",
    "text": "R base\n\nmod_hib <- aov(RG ~ HIBRIDO + BLOCO, data = df_maize)\nmed_hib <- emmeans(mod_hib, ~HIBRIDO)\npwpm(med_hib)\n\n         NP_1     NP_2     NP_3     NP_4   NP_5\nNP_1   [9.48]   1.0000   0.5666   0.0040 0.0002\nNP_2 -0.00075   [9.48]   0.5657   0.0040 0.0002\nNP_3  0.72925  0.73000   [8.75]   0.0533 0.0018\nNP_4  2.23500  2.23575  1.50575   [7.24] 0.3168\nNP_5  3.19700  3.19775  2.46775  0.96200 [6.28]\n\nRow and column labels: HIBRIDO\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n\nplot(med_hib, comparisons = TRUE, CIs = FALSE)"
  },
  {
    "objectID": "FIT5306/FIT5306_09_DBC.html#agror",
    "href": "FIT5306/FIT5306_09_DBC.html#agror",
    "title": "9. Delineamento de Blocos Completos Casualizados",
    "section": "AgroR",
    "text": "AgroR\n\nwith(df_maize,\n     DBC(HIBRIDO, BLOCO, RG))\n\n\n-----------------------------------------------------------------\nNormality of errors\n-----------------------------------------------------------------\n                         Method Statistic   p.value\n Shapiro-Wilk normality test(W)  0.987223 0.9920259\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal\n\n\n\n-----------------------------------------------------------------\nHomogeneity of Variances\n-----------------------------------------------------------------\n                              Method Statistic   p.value\n Bartlett test(Bartlett's K-squared)  7.696982 0.1033304\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous\n\n\n\n-----------------------------------------------------------------\nIndependence from errors\n-----------------------------------------------------------------\n                 Method Statistic   p.value\n Durbin-Watson test(DW)  2.565113 0.7271231\n\n\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent\n\n\n\n-----------------------------------------------------------------\nAdditional Information\n-----------------------------------------------------------------\n\nCV (%) =  8.2\nMStrat/MST =  0.33\nMean =  8.2479\nMedian =  8.0515\nPossible outliers =  No discrepant point\n\n-----------------------------------------------------------------\nAnalysis of Variance\n-----------------------------------------------------------------\n          Df    Sum Sq    Mean.Sq F value        Pr(F)\ntrat       4 32.629952  8.1574881 17.8475 5.449170e-05\nbloco      3 48.794088 16.2646961 35.5850 2.983658e-06\nResiduals 12  5.484793  0.4570661                     \n\n\nAs the calculated p-value, it is less than the 5% significance level. The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ\n\n\n\n\n\n\n-----------------------------------------------------------------\nMultiple Comparison Test\n-----------------------------------------------------------------\n        resp groups\nNP_2 9.48075      a\nNP_1 9.48000      a\nNP_3 8.75075     ab\nNP_4 7.24500     bc\nNP_5 6.28300      c"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html",
    "href": "FIT5306/FIT5306_10_FAT.html",
    "title": "9. Experimentos Fatoriais",
    "section": "",
    "text": "library(tidyverse)\nlibrary(metan)      # estatísticas descritivas\nlibrary(rio)        # importação/exportação de dados\nlibrary(emmeans)    # comparação de médias\nlibrary(AgroR)      # casualização e ANOVA"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#casualização",
    "href": "FIT5306/FIT5306_10_FAT.html#casualização",
    "title": "9. Experimentos Fatoriais",
    "section": "Casualização",
    "text": "Casualização\n\nDelineamento Inteiramente Casualizado\n\nsketch(trat= c(\"A1\", \"A2\"),\n       trat1 = c(\"B1\", \"B2\", \"B3\"),\n       design = \"FAT2DIC\",\n       r = 4)\n\n\n\n\n\n\nDelineamento de Blocos Casualizados\n\nsketch(trat= c(\"A1\", \"A2\"),\n       trat1 = c(\"B1\", \"B2\", \"B3\"),\n       design = \"FAT2DBC\",\n       r = 4)"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#tipos-de-interação",
    "href": "FIT5306/FIT5306_10_FAT.html#tipos-de-interação",
    "title": "9. Experimentos Fatoriais",
    "section": "Tipos de interação",
    "text": "Tipos de interação\n\nAusência de interação\n\n# sem interação\ndfsi <- tribble(\n  ~GEN, ~FONTEN, ~RG,\n  \"Híbrido 1\",\"Ureia\",   5.7,\n  \"Híbrido 1\",\"Nitrato\", 6.8,\n  \"Híbrido 2\",\"Ureia\",   8.2,\n  \"Híbrido 2\",\"Nitrato\", 9.3)\n\np1 <-\n  plot_factbars(dfsi, GEN, FONTEN, resp = RG,\n                ylab = expression(paste(\"RG (Mg \",ha^-1, \")\")),\n                y.expand = 0.2,\n                size.text = 16,\n                values = TRUE,\n                errorbar = F,\n                xlab = \"Híbrido\",\n                legend.position = c(0.2, 0.89)) +\n  ggtitle(\"Ausência de interação\")\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\np1\n\n\n\n\nDe posse dos dados, vamos construir uma tabela dupla entrada com os valores totais e outra com os valores médios. Os efeitos da interação são calculados como…\n\nmat_dfsi <- make_mat(dfsi, GEN, FONTEN, RG)\nmat_dfsi\n\n          Nitrato Ureia\nHíbrido 1     6.8   5.7\nHíbrido 2     9.3   8.2\n\n# tabela dupla entrada (totais)\nmat_dfsi |> \n  row_col_sum()\n\n          Nitrato Ureia row_sums\nHíbrido 1     6.8   5.7     12.5\nHíbrido 2     9.3   8.2     17.5\ncol_sums     16.1  13.9     30.0\n\n# tabela dupla entrada (totais)\nmat_dfsi |> \n  row_col_mean()\n\n          Nitrato Ureia row_means\nHíbrido 1    6.80  5.70      6.25\nHíbrido 2    9.30  8.20      8.75\ncol_means    8.05  6.95      7.50\n\n# soma de quadrados do fator GEN\nrowSums(mat_dfsi) ^ 2\n\nHíbrido 1 Híbrido 2 \n   156.25    306.25 \n\nmodsi <- aov(RG ~ GEN * FONTEN, data = dfsi)\nsummary(modsi)\n\n            Df Sum Sq Mean Sq\nGEN          1   6.25    6.25\nFONTEN       1   1.21    1.21\nGEN:FONTEN   1   0.00    0.00\n\n\n\n\nInteração simples (quantitativa)\n\n# interação simples\ndf_is <- tribble(\n  ~GEN, ~FONTEN, ~RG,\n  \"Híbrido 1\",\"Ureia\",   4.5,\n  \"Híbrido 1\",\"Nitrato\", 1.9,\n  \"Híbrido 2\",\"Ureia\",   11,\n  \"Híbrido 2\",\"Nitrato\", 5.3)\n\n\np2 <-\n  plot_factbars(df_is, GEN, FONTEN, resp = RG,\n                ylab = expression(paste(\"RG (Mg \",ha^-1, \")\")),\n                y.expand = 0.2,\n                size.text = 16,\n                errorbar = F,\n                values = TRUE,\n                xlab = \"Híbrido\",\n                legend.position = c(0.2, 0.89)) +\n  ggtitle(\"Interação simples\")\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\np2\n\n\n\n\n\n\nInteração complexa (qualitativa)\n\n# interação complexa\ndf_ic <- tribble(\n  ~GEN, ~FONTEN, ~RG,\n  \"Híbrido 1\",\"Ureia\",   4.1,\n  \"Híbrido 1\",\"Nitrato\", 1.4,\n  \"Híbrido 2\",\"Ureia\",   6.2,\n  \"Híbrido 2\",\"Nitrato\", 8.4)\n\np3 <-\n  plot_factbars(df_ic, GEN, FONTEN, resp = RG,\n                ylab = expression(paste(\"RG (Mg \",ha^-1, \")\")),\n                y.expand = 0.2,\n                size.text = 16,\n                errorbar = F,\n                values = TRUE,\n                xlab = \"Híbrido\",\n                legend.position = c(0.2, 0.89)) +\n  ggtitle(\"Interação complexa\")\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\nWarning in qt(level/2 + 0.5, n() - 1): NaNs produzidos\n\np3"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#modelo-estatístico",
    "href": "FIT5306/FIT5306_10_FAT.html#modelo-estatístico",
    "title": "9. Experimentos Fatoriais",
    "section": "Modelo estatístico",
    "text": "Modelo estatístico\nVamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos \\(\\alpha\\) e \\(\\tau\\), em uma determinada variável resposta. O modelo estatístico considerado neste tipo de experimento é:\n\\[\n{y_{ijk}} = {\\rm{ }}\\mu {\\rm{ }} + {\\rm{ }}\\mathop \\beta \\nolimits_{k}  + \\mathop \\alpha \\nolimits_i  + \\mathop \\tau \\nolimits_j  + \\mathop {(\\alpha \\tau )}\\nolimits_{ij}  + {\\rm{ }}\\mathop \\varepsilon \\nolimits_{ijk}\n\\]\nonde \\({y_{ijk}}\\) é o valor observado da combinação do i-ésimo nível do fator \\(\\alpha\\) com o j-ésimo nível do fator \\(\\tau\\) no k-ésimo bloco; \\(\\mu\\) é a média geral; \\(\\mathop \\beta \\nolimits_{k}\\) é o efeito do bloco k; \\(\\mathop \\alpha \\nolimits_i\\) é o efeito do i-ésimo nível de \\(\\alpha\\) ; \\(\\mathop \\tau \\nolimits_j\\) é o efeito do j-ésimo nível de \\(\\tau\\) ; \\(\\mathop {(\\alpha \\tau )}\\nolimits_{ij}\\) é o efeito da interação do i-ésimo nível de \\(\\alpha\\) com o j-ésimo nível de \\(\\tau\\); e \\(\\mathop \\varepsilon \\nolimits_{ijk}\\) é o erro aleatório associado a \\({y_{ijk}}\\), assumindo \\(\\mathop \\varepsilon \\nolimits_{ijk} \\mathop \\cap \\limits^{iid} N(0,\\mathop \\sigma \\nolimits^2 )\\).\nBasicamente, estes fatores podem ser divididos em dois tipos: qualitativos e quantitativos. Um fator qualitativo é, como o nome já diz, relacionado a qualidade, ou seja, diferentes em tipo, mas não em quantidade. Como exemplo, podemos citar cultivares, defensivos agrícolas, práticas de manejo, etc. Um fator quantitativo, por outro lado, é caracterizado pela quantidade utilizada no experimento. Podemos citar, por exemplo, doses de adubação. Cabe ressaltar que o termo fatorial não indica um delineamento experimental, mas uma forma de arranjo de tratamentos na área parcela. Estes experimentos podem ser conduzidos tanto em DIC quanto DBC. Assim, em cada repetição/bloco, o tratamento a ser aplicado é a combinação dos níveis dos dois fatores."
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#conjunto-de-dados",
    "href": "FIT5306/FIT5306_10_FAT.html#conjunto-de-dados",
    "title": "9. Experimentos Fatoriais",
    "section": "Conjunto de dados",
    "text": "Conjunto de dados\nO conjunto de dados utilizado neste exemplo é adaptado de OLIVOTO et al. (2016) sendo oriundo de um experimento que testou o efeito de diferentes parcelamentos de nitrogênio (N) associado ao uso de enxofre (S) na produtividade, componentes do rendimento e qualidade reológica da farinha de trigo.\n\nOLIVOTO, T. et al. Sulfur and nitrogen effects on industrial quality and grain yield of wheat. Revista de Ciências Agroveterinárias, v. 15, n. 1, p. 24–33, 2016. Disponível em: https://doi.org/10.5965/223811711512016024\n\nOs tratamentos consistiram da combinação de três níveis de parcelamento de N (DA: 100% no duplo anel; AF+DA: 50% no afilhamento + 50% no duplo anel; DA+ES: 50% no afilhamento + 50% no espigamento) e dois níveis de enxofre (S+: com enxofre; S-: sem enxofre).\nPara fins didáticos, a extensibilidade da massa (L, mm) é utilizada. Para importação, utiliza-se a função import() do pacote rio. A função as_factor converte as primeiras três colunas para fator.\n\nurl <- \"https://bit.ly/df_biostat\"\ndf_fat <- \n  import(url, sheet = \"FAT1_CI2\", setclass = \"tbl\") |>\n  as_factor(1:3)\n\nNo seguinte gráfico, apresento as médias observadas da extensibilidade nos diferentes tratamentos.\n\nplot_factbars(df_fat, ENX, NIT, resp = L)"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#verificação-de-outliers",
    "href": "FIT5306/FIT5306_10_FAT.html#verificação-de-outliers",
    "title": "9. Experimentos Fatoriais",
    "section": "Verificação de outliers",
    "text": "Verificação de outliers\nA função inspect do pacote metan é utilizada para inspecionar o conjunto de dados. Com esta função, é possível identificar possíveis outliers, bem como valores faltantes.\n\ninspect(df_fat, plot = TRUE)\n## # A tibble: 4 × 10\n##   Variable Class   Missing Levels Valid_n   Min Median   Max Outlier Text \n##   <chr>    <chr>   <chr>   <chr>    <int> <dbl>  <dbl> <dbl>   <dbl> <lgl>\n## 1 ENX      factor  No      2           24    NA   NA      NA      NA NA   \n## 2 NIT      factor  No      3           24    NA   NA      NA      NA NA   \n## 3 REP      factor  No      4           24    NA   NA      NA      NA NA   \n## 4 L        numeric No      -           24    67   78.5    96       0 NA"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#estatística-descritiva",
    "href": "FIT5306/FIT5306_10_FAT.html#estatística-descritiva",
    "title": "9. Experimentos Fatoriais",
    "section": "Estatística descritiva",
    "text": "Estatística descritiva\nA função desc_stat() do pacote metan computa estatísticas descritivas para a variável L.\n\ndesc_stat(df_fat)\n## # A tibble: 1 × 10\n##   variable    cv   max  mean median   min sd.amo    se  ci.t n.valid\n##   <chr>    <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl> <dbl> <dbl>   <dbl>\n## 1 L         10.5    96  80.4   78.5    67   8.43  1.72  3.56      24"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#análise-de-variância",
    "href": "FIT5306/FIT5306_10_FAT.html#análise-de-variância",
    "title": "9. Experimentos Fatoriais",
    "section": "Análise de variância",
    "text": "Análise de variância\n\nManual\n\nmat_df_fat <- make_mat(df_fat, ENX, NIT, L, fun = sum)\nmat_df_fat\n\n   AF+DA  DA DA+ES\nS-   297 316   310\nS+   286 373   347\n\n# total dos blocos\ntbloco <- sum_by(df_fat, REP) |> pull()\n\nI <- nlevels(df_fat$ENX)\nJ <- nlevels(df_fat$NIT)\nK <- nlevels(df_fat$REP)\n\n# fator de correção\nC <- sum(df_fat$L) ^ 2  / (I*J*K)\n# soma de quadrado total\nsqtot <- sum(df_fat$L ^ 2) - C\n# soma de quadrado de bloco\nsqbloco <- sum(tbloco ^ 2) / (I*J) - C\n# soma de quadrados de ENX (a)\nsqa <- sum(rowSums(mat_df_fat) ^ 2)  / (J * K) -  C\n# soma de quadrados de NIT (b)\nsqb <- sum(colSums(mat_df_fat) ^ 2)  / (I * K) -  C\n# soma de quadrados da interação (a x b)\nsqab <- sum(mat_df_fat ^ 2)  / K -  C - sqa - sqb\n# soma de quadrado do erro\nsqerr <- sqtot - sqa - sqb - sqab - sqbloco\n\n\n# montar a tabela\nFV <- c(\"BLOCO\", \"ENX\", \"NIT\", \"ENX*NIT\", \"ERRO\", \"TOTAL\")\nGL <- c(3, 1, 2, 2, 15, 23)\nSQ <- c(sqbloco, sqa, sqb, sqab, sqerr, sqtot)\nQM <- SQ / GL\nFC <- QM / QM[5]\nFC[5:6] <- NA\n\ndata.frame(FV = FV, GL = GL, SQ = SQ, QM = QM, FC = FC)\n\n       FV GL         SQ         QM         FC\n1   BLOCO  3   10.45833   3.486111  0.1779889\n2     ENX  1  287.04167 287.041667 14.6553680\n3     NIT  2  739.00000 369.500000 18.8654092\n4 ENX*NIT  2  305.33333 152.666667  7.7946391\n5    ERRO 15  293.79167  19.586111         NA\n6   TOTAL 23 1635.62500  71.114130         NA\n\n\nA análise de variância é computada no software R utilizando a função aov(). Considerando o Delineamento de Blocos Casualizados (DBC), as três fontes de variação incluídas no modelo são a de enxofre (ENX), nitrogênio (NIT) e bloco (REP). Note que todos os termos (efeito principal e interação) podem ser declarados quando se utiliza ENX*NIT; também é possível indicar termos específicos no modelo.\n\n# opção 1\nanova <- aov(L ~ ENX*NIT + REP, data = df_fat)\n# modelo idêntico, indicando os termos explicitamente\nanova <- aov(L ~ ENX + NIT + ENX:NIT + REP, data = df_fat)\nsummary(anova)\n##             Df Sum Sq Mean Sq F value   Pr(>F)    \n## ENX          1  287.0   287.0  14.655  0.00165 ** \n## NIT          2  739.0   369.5  18.865 8.04e-05 ***\n## REP          3   10.5     3.5   0.178  0.90965    \n## ENX:NIT      2  305.3   152.7   7.795  0.00477 ** \n## Residuals   15  293.8    19.6                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#comparação-de-médias",
    "href": "FIT5306/FIT5306_10_FAT.html#comparação-de-médias",
    "title": "9. Experimentos Fatoriais",
    "section": "Comparação de médias",
    "text": "Comparação de médias\nA análise de variância revelou efeito significativo da interação. Nesse caso, segue-se comparando as médias do fator nitrogênio dentro de cada nível do fator enxofre e do enxofre dentro de cada nível do fator nitrogênio. Para isso, utilizo o pacote emmeans (teste Tukey). Nesta abordagem, a avaliação da significância das médias de dois tratamentos é dada pela sobreposição das flechas de cada tratamento. Se dois tratamentos apresentam setas que se sobrepõem (considerando o eixo x), assume-se que estes tratamentos são estatisticamente diferentes um do outro.\n\nmedias_fat <- emmeans(anova, ~ NIT | ENX)\nplot(medias_fat,\n     CIs = FALSE, # remove os intervalos de confiança das médias\n     comparisons = TRUE) # insere setas para comparação de médias (Tukey)"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#pacote-agror",
    "href": "FIT5306/FIT5306_10_FAT.html#pacote-agror",
    "title": "9. Experimentos Fatoriais",
    "section": "Pacote AgroR",
    "text": "Pacote AgroR\nNo pacote agroR, a análise de variância neste delineamento pode ser realizada com a função FAT2DBC().\n\nwith(df_fat,\n     FAT2DBC(ENX, NIT, REP, L))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic    p.value\n##  Shapiro-Wilk normality test(W)  0.922206 0.06536118\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic  p.value\n##  Bartlett test(Bartlett's K-squared)  2.459752 0.782544\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic    p.value\n##  Durbin-Watson test(DW)  1.682362 0.04036279\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  5.51\n## Mean =  80.375\n## Median =  78.5\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##               Df    Sum Sq    Mean.Sq    F value        Pr(F)\n## Fator1         1 287.04167 287.041667 14.6553680 1.645485e-03\n## Fator2         2 739.00000 369.500000 18.8654092 8.038974e-05\n## bloco          3  10.45833   3.486111  0.1779889 9.096501e-01\n## Fator1:Fator2  2 305.33333 152.666667  7.7946391 4.774361e-03\n## Residuals     15 293.79167  19.586111                        \n## \n## -----------------------------------------------------------------\n## \n## Significant interaction: analyzing the interaction\n## \n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## Analyzing  F1  inside of each level of  F2\n## -----------------------------------------------------------------\n##                        Df Sum Sq Mean Sq F value    Pr(>F)    \n## bloco                   3  10.46    3.49  0.1780 0.9096501    \n## Fator2                  2 739.00  369.50 18.8654 8.039e-05 ***\n## Fator2:Fator1           3 592.38  197.46 10.0815 0.0006909 ***\n##   Fator2:Fator1: AF+DA  1  15.13   15.13  0.7722 0.3933874    \n##   Fator2:Fator1: DA     1 406.12  406.12 20.7354 0.0003805 ***\n##   Fator2:Fator1: DA+ES  1 171.12  171.12  8.7371 0.0098160 ** \n## Residuals              15 293.79   19.59                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## -----------------------------------------------------------------\n## Analyzing  F2  inside of the level of  F1\n## -----------------------------------------------------------------\n## \n##                     Df  Sum Sq Mean Sq F value    Pr(>F)    \n## bloco                3   10.46    3.49  0.1780  0.909650    \n## Fator1               1  287.04  287.04 14.6554  0.001645 ** \n## Fator1:Fator2        4 1044.33  261.08 13.3300 7.897e-05 ***\n##   Fator1:Fator2: S-  2   47.17   23.58  1.2041  0.327368    \n##   Fator1:Fator2: S+  2  997.17  498.58 25.4560 1.508e-05 ***\n## Residuals           15  293.79   19.59                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n## \n## -----------------------------------------------------------------\n## Final table\n## -----------------------------------------------------------------\n##      AF+DA      DA   DA+ES\n## S- 74.2 aA 79.0 bA 77.5 bA\n## S+ 71.5 aB 93.2 aA 86.8 aA"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#casualização-1",
    "href": "FIT5306/FIT5306_10_FAT.html#casualização-1",
    "title": "9. Experimentos Fatoriais",
    "section": "Casualização",
    "text": "Casualização\n\nsketch(trat= c(\"A1\", \"A2\"),\n       trat1 = c(\"B1\", \"B2\", \"B3\"),\n       design = \"PSUBDBC\",\n       r = 4)"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#análise-de-variância-1",
    "href": "FIT5306/FIT5306_10_FAT.html#análise-de-variância-1",
    "title": "9. Experimentos Fatoriais",
    "section": "Análise de variância",
    "text": "Análise de variância\nConsiderando o mesmo conjunto de dados do exemplo anterior e assumindo que o enxofre estava casualizado nas parcelas principais e o nitrogênio nas subparcelas, a análise de variância no software R é computada conforme segue\n\nanova_psub <- aov(L ~ ENX*NIT + Error(REP/ENX), data = df_fat)\nsummary(anova_psub)\n\n\nError: REP\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals  3  10.46   3.486               \n\nError: REP:ENX\n          Df Sum Sq Mean Sq F value Pr(>F)  \nENX        1 287.04  287.04   18.94 0.0224 *\nResiduals  3  45.46   15.15                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nNIT        2  739.0   369.5  17.855 0.000253 ***\nENX:NIT    2  305.3   152.7   7.377 0.008142 ** \nResiduals 12  248.3    20.7                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#pacote-agror-1",
    "href": "FIT5306/FIT5306_10_FAT.html#pacote-agror-1",
    "title": "9. Experimentos Fatoriais",
    "section": "Pacote AgroR",
    "text": "Pacote AgroR\nNo pacote agroR, a análise de variância neste delineamento pode ser realizada com a função PSUBDBC().\n\nwith(df_fat,\n     PSUBDBC(ENX, NIT, REP, L))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic    p.value\n##  Shapiro-Wilk normality test(W)  0.922206 0.06536118\n## \n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n## Plot\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared) 0.6768708 0.4106663\n## \n## \n## ----------------------------------------------------\n## Split-plot\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared)  1.817323 0.4030634\n## \n## \n## ----------------------------------------------------\n## Interaction\n##                               Method Statistic  p.value\n##  Bartlett test(Bartlett's K-squared)  2.459752 0.782544\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV1 (%) =  4.84\n## CV2 (%) =  5.66\n## Mean =  80.375\n## Median =  78.5\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##         Df Sum Sq    Mean Sq    F value    Pr(>F) \n## F1       1 287.04167 287.041667 18.9431714 0.022  \n## Block    3  10.45833   3.486111  0.2300642 0.871  \n## Error A  3  45.45833  15.152778                   \n## F2       2 739.00000 369.500000 17.8550336 p<0.001\n## F1 x F2  2 305.33333 152.666667  7.3771812 0.008  \n## Error B 12 248.33333  20.694444                   \n## -----------------------------------------------------------------\n## Significant interaction: analyzing the interaction\n## -----------------------------------------------------------------\n## Analyzing  F1  inside of each level of  F2\n## -----------------------------------------------------------------\n##                      GL       SQ        QM        Fc  p.value\n## F1 : F2 AF+DA   1.00000  15.1250  15.12500  0.802506 0.384898\n## F1 : F2 DA      1.00000 406.1250 406.12500 21.548268 0.000343\n## F1 : F2 DA+ES   1.00000 171.1250 171.12500  9.079587 0.008963\n## Combined error 14.57876 274.7691  18.84722                   \n## \n## -----------------------------------------------------------------\n## Analyzing  F2  inside of the level of  F1\n## -----------------------------------------------------------------\n##             GL        SQ        QM        Fc  p.value\n## F2 : F1 S-   2  47.16667  23.58333  1.139597 0.352262\n## F2 : F1 S+   2 997.16667 498.58333 24.092617  6.3e-05\n## Error b     12 248.33333  20.69444\n\n\n\n## \n## -----------------------------------------------------------------\n## Final table\n## -----------------------------------------------------------------\n##      AF+DA      DA   DA+ES\n## S- 74.2 aA 79.0 bA 77.5 bA\n## S+ 71.5 aB 93.2 aA 86.8 aA"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#experimento1",
    "href": "FIT5306/FIT5306_10_FAT.html#experimento1",
    "title": "9. Experimentos Fatoriais",
    "section": "Coberturas de solo e doses de nitrogênio (efeito na massa de cobertura de inverno)",
    "text": "Coberturas de solo e doses de nitrogênio (efeito na massa de cobertura de inverno)\nO delineamento experimental utilizado foi o delineamento de blocos casualizados com parcelas subdivididas em esquema fatorial 4x2 com quatro repetições. quatro espécies: aveia preta cv. BRS 139 (Neblina), com densidade de 120 kg ha\\(^{-1}\\) de semente; triticale cv. BRS SATURNO, com densidade de 160 kg ha\\(^{-1}\\) de semente e centeio cv. BRS PROGRESSO, com densidade de 160 kg ha\\(^{-1}\\) de semente, além do pousio, com presença de diferentes plantas que se desenvolvem nesta época (três espécies de gramíneas); com dois manejos de nitrogênio (com ou sem N em cobertuta). Os tratamentos foram alocados na área experimental em formato de parcelas subdivididas. Na parcela principal foram alocadas as espécies nas subparcela o manejo de nitrogênio. Nas parcelas que receberam N utilizou-se como fonte a ureia (45% de N) na dose de 100 kg ha\\(^{-1}\\).\n\nPacotes e dados\nAssumindo que todos estão instalados, é só carregar com\n\nlibrary(rio) # importar e exportar arquivos\nlibrary(ExpDes.pt) # fazer anova\nlibrary(metan) # gráficos\nlibrary(tidyverse) # manipulação de dados e gráficos\n\n# dados\nurl <- \"https://bit.ly/df_biostat\"\ndf_cobmassa <- import(url, sheet = \"COBERTURA_N_MASSA\", setclass = \"tbl\")\ndf_cobmassa <- as_factor(df_cobmassa, 1:3)\n\n# Apenas para mostrar a estrutura dos dados\ndf_cobmassa\n\n# A tibble: 32 × 6\n   NITROGENIO ESPECIE     REP       MV    MS   MSR\n   <fct>      <fct>       <fct>  <dbl> <dbl> <dbl>\n 1 Sem N      Aveia Preta 1     17939. 3640.  53.2\n 2 Sem N      Aveia Preta 2     20738. 4190. 709. \n 3 Sem N      Aveia Preta 3     37780  6958. 688  \n 4 Sem N      Aveia Preta 4     15448  3055.  98  \n 5 Sem N      Centeio     1     30836. 7001. 347. \n 6 Sem N      Centeio     2     22246  5540  246. \n 7 Sem N      Centeio     3     12422  3330. 169. \n 8 Sem N      Centeio     4     15220. 3797. 213. \n 9 Sem N      Triticale   1     14700. 2989. 268. \n10 Sem N      Triticale   2     19146. 3652. 399. \n# … with 22 more rows\n\n\n\n\nEstatistica descritiva\n\ndesc_stat(df_cobmassa, stats = c(\"min, mean, max\"))\n\n# A tibble: 3 × 4\n  variable    min   mean    max\n  <chr>     <dbl>  <dbl>  <dbl>\n1 MS       1576.   5053.  7573.\n2 MSR        53.2   373.   738 \n3 MV       6413.  25210. 45076.\n\n\n\n\nANOVA\nO modelo considerado para este exemplo de parcela subdivididas é o seguinte\n\\[\n{y_{ijk}} = {\\rm{ }}\\mu {\\rm{ }} + {\\rm{ }}\\mathop \\alpha \\nolimits_i + \\mathop \\beta \\nolimits_{k} + \\mathop \\eta \\nolimits_{ik}  +\\mathop \\tau \\nolimits_j  + \\mathop {(\\alpha \\tau )}\\nolimits_{ij}  + {\\rm{ }}\\mathop \\varepsilon \\nolimits_{ijk}\n\\]\nonde \\({y_{ijk}}\\) é a variável resposta observada; \\(\\mu\\) é a média geral; \\(\\mathop \\alpha \\nolimits_i\\) é o efeito do \\(i\\)-ésimo nível do fator espécie de cobertura ; \\(\\mathop \\beta \\nolimits_{k}\\) é o efeito do bloco \\(k\\); \\(\\mathop \\eta \\nolimits_{ik}\\) é o erro de parcela, mais conhecido como erro a; \\(\\mathop \\tau \\nolimits_j\\) é o efeito do \\(j\\)-ésimo nível do fator nitrogênio; \\(\\mathop {(\\alpha \\tau )}\\nolimits_{ij}\\) é o efeito da interação do \\(i\\)-ésimo nível do fator espécie com o \\(j\\)-ésimo nível do fator nitrogênio; e \\(\\mathop \\varepsilon \\nolimits_{ijk}\\) é o erro da subparcela, mais conhecido como erro b.\n\nMassa verde (MV) por ha\nANOVA\n\nwith(df_cobmassa,\n     psub2.dbc(fator1 = ESPECIE,\n               fator2 = NITROGENIO,\n               bloco = REP,\n               resp = MV,\n               fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1 (parcela):  ESPECIE \nFATOR 2 (subparcela):  NITROGENIO \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL         SQ        QM      Fc  Pr(>Fc)    \nESPECIE             3  416543558 138847853  1.2283 0.354965    \nBloco               3   77123097  25707699  0.2274 0.875004    \nErro a              9 1017377902 113041989                     \nNITROGENIO          1  743336547 743336547 20.7774 0.000657 ***\nESPECIE*NITROGENIO  3   86334790  28778264  0.8044 0.515204    \nErro b             12  429314110  35776176                     \nTotal              31 2770030005                               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n------------------------------------------------------------------------\nCV 1 = 42.17338 %\nCV 2 = 23.72551 %\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis   Medias\n1 Aveia Preta 30469.15\n2     Centeio 24084.35\n3      Pousio 20441.70\n4   Triticale 25846.80\n------------------------------------------------------------------------\nNITROGENIO\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na    Com N   30030.17 \n b   Sem N   20390.83 \n------------------------------------------------------------------------\n\n\nGRÁFICO\nComo somente foi observado efeito significativo para o fator nitrogênio, prossegue-se com a comparação de médias para o efeito de N, conforme resultado do Teste Tukey acima. Neste gráfico, as barras mostram a média e as barras de erro, o erro padrão da média. Apenas para apresentação, incluo também a média do fator cobertura de solo, sem as letras pois o seu efeito não foi significativo, segundo a ANOVA.\n\npn_mv <- \n  plot_bars(df_cobmassa,\n            x = NITROGENIO,\n            y = MV,\n            lab.bar = c(\"a\", \"b\"),\n            xlab = \"Aplicação de Nitrogênio (N)\",\n            ylab = \"Matéria verde (kg/ha)\")\n\npcob_mv <- \n  plot_bars(df_cobmassa,\n            x = ESPECIE,\n            y = MV,\n            xlab = \"Espécies\",\n            ylab = \"Matéria verde (kg/ha)\") +\n  geom_hline(yintercept = mean(df_cobmassa$MV))\n\n# organiza os gráficos\narrange_ggplot(pn_mv, pcob_mv)\n\n\n\n\n\n\nMassa seca (MS) por ha\nANOVA\n\nwith(df_cobmassa,\n     psub2.dbc(fator1 = ESPECIE,\n               fator2 = NITROGENIO,\n               bloco = REP,\n               resp = MS,\n               fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1 (parcela):  ESPECIE \nFATOR 2 (subparcela):  NITROGENIO \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL       SQ       QM     Fc Pr(>Fc)  \nESPECIE             3 11614132  3871377 1.0190 0.42877  \nBloco               3  1466451   488817 0.1287 0.94066  \nErro a              9 34191281  3799031                 \nNITROGENIO          1 14139498 14139498 8.1851 0.01433 *\nESPECIE*NITROGENIO  3  1476172   492057 0.2848 0.83542  \nErro b             12 20729720  1727477                 \nTotal              31 83617255                          \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n------------------------------------------------------------------------\nCV 1 = 38.57428 %\nCV 2 = 26.01163 %\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis  Medias\n1 Aveia Preta 5402.25\n2     Centeio 5647.55\n3      Pousio 4065.85\n4   Triticale 5095.85\n------------------------------------------------------------------------\nNITROGENIO\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na    Com N   5717.6 \n b   Sem N   4388.15 \n------------------------------------------------------------------------\n\n\nGRÁFICO\nComo somente foi observado efeito significativo para o fator nitrogênio, prossegue-se com a comparação de médias para o efeito de N, conforme resultado do Teste Tukey acima. Apenas para apresentação, incluo também a média do fator cobertura de solo, sem as letras pois o seu efeito não foi significativo, segundo a ANOVA.\n\npn_ms <- \n  plot_bars(df_cobmassa,\n            x = NITROGENIO,\n            y = MS,\n            lab.bar = c(\"a\", \"b\"),\n            xlab = \"Aplicação de Nitrogênio (N)\",\n            ylab = \"Matéria seca (kg/ha)\")\n\npcob_ms <- \n  plot_bars(df_cobmassa,\n            x = ESPECIE,\n            y = MS,\n            xlab = \"Espécies\",\n            ylab = \"Matéria seca (kg/ha)\") +\n  geom_hline(yintercept = mean(df_cobmassa$MS))\n\n# organiza os gráficos\narrange_ggplot(pn_ms, pcob_ms)\n\n\n\n\n\n\nMassa seca de raiz (MSR) por ha\nANOVA\n\nwith(df_cobmassa,\n     psub2.dbc(fator1 = ESPECIE,\n               fator2 = NITROGENIO,\n               bloco = REP,\n               resp = MSR,\n               fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1 (parcela):  ESPECIE \nFATOR 2 (subparcela):  NITROGENIO \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL      SQ     QM      Fc  Pr(>Fc)    \nESPECIE             3  160868  53623  0.9543 0.454941    \nBloco               3  217735  72578  1.2916 0.335534    \nErro a              9  505724  56192                     \nNITROGENIO          1  141512 141512 21.4205 0.000582 ***\nESPECIE*NITROGENIO  3   44728  14909  2.2568 0.134138    \nErro b             12   79277   6606                     \nTotal              31 1149844                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n------------------------------------------------------------------------\nCV 1 = 63.48783 %\nCV 2 = 21.76891 %\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis Medias\n1 Aveia Preta  405.7\n2     Centeio  365.6\n3      Pousio  264.4\n4   Triticale  457.8\n------------------------------------------------------------------------\nNITROGENIO\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na    Com N   439.875 \n b   Sem N   306.875 \n------------------------------------------------------------------------\n\n\nGRÁFICO\nComo somente foi observado efeito significativo para o fator nitrogênio, prossegue-se com a comparação de médias para o efeito de N, conforme resultado do Teste Tukey acima. Apenas para apresentação, incluo também a média do fator cobertura de solo, sem as letras pois o seu efeito não foi significativo, segundo a ANOVA.\n\npn_msr <- \n  plot_bars(df_cobmassa,\n            x = NITROGENIO,\n            y = MSR,\n            lab.bar = c(\"a\", \"b\"),\n            xlab = \"Aplicação de Nitrogênio (N)\",\n            ylab = \"Massa seca de raiz (kg/ha)\")\n\npcob_msr <- \n  plot_bars(df_cobmassa,\n            x = ESPECIE,\n            y = MSR,\n            xlab = \"Espécies\",\n            ylab = \"Massa seca de raiz (kg/ha)\") +\n  geom_hline(yintercept = mean(df_cobmassa$MSR))\n\n# organiza os gráficos\narrange_ggplot(pn_msr, pcob_msr)"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#coberturas-de-solo-e-doses-de-nitrogênio-efeito-na-cultura-da-soja",
    "href": "FIT5306/FIT5306_10_FAT.html#coberturas-de-solo-e-doses-de-nitrogênio-efeito-na-cultura-da-soja",
    "title": "9. Experimentos Fatoriais",
    "section": "Coberturas de solo e doses de nitrogênio (efeito na cultura da soja)",
    "text": "Coberturas de solo e doses de nitrogênio (efeito na cultura da soja)\nOs tratamentos e delineamentos são descritos no exemplo anterior. Aqui, são analisados os dados observados na cultura da soja, semeada na resteva de cada tratamento (combinação de N e espécies de cobertura)\n\nPacotes e dados\nAssumindo que todos estão instalados, é só carregar com\n\nlibrary(rio) # importar e exportar arquivos\nlibrary(ExpDes.pt) # fazer anova\nlibrary(metan) # gráficos\nlibrary(tidyverse) # manipulação de dados e gráficos\n\n# dados\nurl <- \"https://bit.ly/df_biostat\"\ndf_cobsoja <- import(url, sheet = \"COBERTURA_N_SOJA\", setclass = \"tbl\")\ndf_cobsoja <- as_factor(df_cobsoja, 1:3)\n\n# Apenas para mostrar a estrutura dos dados\ndf_cobsoja\n\n# A tibble: 32 × 7\n   ESPECIE     NITROGENIO REP      NL   NGL   MMG    RG\n   <fct>       <fct>      <fct> <dbl> <dbl> <dbl> <dbl>\n 1 Aveia Preta Sem N      R1     30    2.25   180 3547.\n 2 Aveia Preta Sem N      R2     40.8  2.55   190 4117.\n 3 Aveia Preta Sem N      R3     34.6  2.6    170 3381.\n 4 Aveia Preta Sem N      R4     37.6  2.52   160 3733.\n 5 Centeio     Sem N      R1     38.6  2.15   180 3819.\n 6 Centeio     Sem N      R2     40.6  2.1    170 1739.\n 7 Centeio     Sem N      R3     37.6  2.48   180 3928.\n 8 Centeio     Sem N      R4     38    2.39   150 3339.\n 9 Triticale   Sem N      R1     35.6  2.46   210 4400 \n10 Triticale   Sem N      R2     32.2  2.42   200 4378.\n# … with 22 more rows\n\n\n\n\nEstatistica descritiva\n\ndesc_stat(df_cobsoja, stats = c(\"min, mean, max\"))\n\n# A tibble: 4 × 4\n  variable    min    mean     max\n  <chr>     <dbl>   <dbl>   <dbl>\n1 MMG      150     178.    210   \n2 NGL        1.97    2.43    2.82\n3 NL        22.6    38.6    53.2 \n4 RG       675    3288.   4861.  \n\n\n\n\nANOVA\nO modelo considerado é descrito no exemplo anterior.\n\nVariável número de legumes por planta (NL)\nANOVA\n\nwith(df_cobsoja,\n     fat2.dbc(fator1 = ESPECIE,\n              fator2 = NITROGENIO,\n              bloco = REP,\n              resp = NL,\n              fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  ESPECIE \nFATOR 2:  NITROGENIO \n------------------------------------------------------------------------\n\n\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL      SQ QM     Fc   Pr>Fc\nBloco               3   18.72  6 0.1640 0.91940\nESPECIE             3  148.99  5 1.3051 0.29904\nNITROGENIO          1    2.76  3 0.0726 0.79027\nESPECIE*NITROGENIO  3  430.67  2 3.7724 0.02607\nResiduo            21  799.15  4               \nTotal              31 1400.30  1               \n------------------------------------------------------------------------\nCV = 16 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.5520582 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\n\n\nInteracao significativa: desdobrando a interacao\n------------------------------------------------------------------------\n\nDesdobrando  ESPECIE  dentro de cada nivel de  NITROGENIO \n------------------------------------------------------------------------\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                         GL         SQ        QM     Fc  Pr.Fc\nBloco                     3   18.72375   6.24125  0.164 0.9194\nNITROGENIO                1    2.76125   2.76125 0.0726 0.7903\nESPECIE:NITROGENIO Com N  3  513.04000 171.01333 4.4939 0.0138\nESPECIE:NITROGENIO Sem N  3   66.62750  22.20917 0.5836 0.6323\nResiduo                  21  799.14625  38.05458              \nTotal                    31 1400.29875  45.17093              \n------------------------------------------------------------------------\n\n\n\n ESPECIE  dentro do nivel  Com N  de  NITROGENIO \n------------------------------------------------------------------------\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na    1   44.65 \na    2   43.55 \nab   4   36.55 \n b   3   30.65 \n------------------------------------------------------------------------\n\n\n ESPECIE  dentro do nivel  Sem N  de  NITROGENIO \n\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis Medias\n1      1  35.75\n2      2  38.70\n3      3  41.30\n4      4  37.30\n------------------------------------------------------------------------\n\n\n\nDesdobrando  NITROGENIO  dentro de cada nivel de  ESPECIE \n------------------------------------------------------------------------\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                               GL         SQ        QM     Fc  Pr.Fc\nBloco                           3   18.72375   6.24125  0.164 0.9194\nESPECIE                         3  148.99375  49.66458 1.3051  0.299\nNITROGENIO:ESPECIE Aveia Preta  1  158.42000 158.42000  4.163 0.0541\nNITROGENIO:ESPECIE Centeio      1   47.04500  47.04500 1.2363 0.2788\nNITROGENIO:ESPECIE Pousio       1  226.84500 226.84500  5.961 0.0236\nNITROGENIO:ESPECIE Triticale    1    1.12500   1.12500 0.0296 0.8651\nResiduo                        21  799.14625  38.05458              \nTotal                          31 1400.29875  45.17093              \n------------------------------------------------------------------------\n\n\n\n NITROGENIO  dentro do nivel  Aveia Preta  de  ESPECIE \n\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis Medias\n1      1  44.65\n2      2  35.75\n------------------------------------------------------------------------\n\n\n NITROGENIO  dentro do nivel  Centeio  de  ESPECIE \n\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis Medias\n1      1  43.55\n2      2  38.70\n------------------------------------------------------------------------\n\n\n NITROGENIO  dentro do nivel  Pousio  de  ESPECIE \n------------------------------------------------------------------------\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na    2   41.3 \n b   1   30.65 \n------------------------------------------------------------------------\n\n\n NITROGENIO  dentro do nivel  Triticale  de  ESPECIE \n\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis Medias\n1      1  36.55\n2      2  37.30\n------------------------------------------------------------------------\n\n\nGRÁFICO\nComo não a houve diferença para os efeitos principais (ESPECIE E NITROGÊNIO) mas deu interação entre estes fatores, vamos apresentar um gráfico mostrando essa interação. No gráfico, letras maiúsculas comparam as espécies dentro de cada manejo de N e minúsculas comparam o manejo de N dentro de cada espécie. As barras mostram a média e as barras de erro, o erro padrão da média.\n\nplot_factbars(df_cobsoja, ESPECIE, NITROGENIO,\n              resp = NL,\n              lab.bar = c(\"Aa\", \"Aa\", \"Aa\", \"Aa\", \"Bb\", \"Aa\", \"ABa\", \"Aa\"),\n              y.expand = 0.1,\n              xlab = \"Espécie\",\n              ylab = \"Número de legumes por planta\")\n\n\n\n\n\n\nVariável número de grãos por legume (NGL)\nANOVA\n\nwith(df_cobsoja,\n     fat2.dbc(fator1 = ESPECIE,\n              fator2 = NITROGENIO,\n              bloco = REP,\n              resp = NGL,\n              fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  ESPECIE \nFATOR 2:  NITROGENIO \n------------------------------------------------------------------------\n\n\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL      SQ QM     Fc    Pr>Fc\nBloco               3 0.19640  5 2.3475 0.101764\nESPECIE             3 0.14872  4 1.7776 0.182257\nNITROGENIO          1 0.08405  6 3.0138 0.097208\nESPECIE*NITROGENIO  3 0.14872  3 1.7776 0.182257\nResiduo            21 0.58565  2                \nTotal              31 1.16355  1                \n------------------------------------------------------------------------\nCV = 6.88 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.3640228 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis  Medias\n1 Aveia Preta 2.42250\n2     Centeio 2.32875\n3      Pousio 2.44375\n4   Triticale 2.52000\n------------------------------------------------------------------------\nNITROGENIO\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis Medias\n1  Com N 2.4800\n2  Sem N 2.3775\n------------------------------------------------------------------------\n\n\n\nCOMO NÃO DEU DIFERENÇA SIGNIFICATIVA PARA NENHUM FATOR, PODE-SE APENAS APRESENTAR O GRÁFICO, MAS SEM DISCUTIR DIFERENÇAS ENTRE OS TRATAMENTOS/N\n\n\nplot_factbars(df_cobsoja, ESPECIE, NITROGENIO,\n              resp = NGL,\n              y.expand = 0.1,\n              xlab = \"Espécie\",\n              ylab = \"Número de grãos por legume\")\n\n\n\n\n\n\nVariável massa de mil grãos (MMG)\nANOVA\n\nwith(df_cobsoja,\n     fat2.dbc(fator1 = ESPECIE,\n              fator2 = NITROGENIO,\n              bloco = REP,\n              resp = MMG,\n              fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  ESPECIE \nFATOR 2:  NITROGENIO \n------------------------------------------------------------------------\n\n\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL     SQ QM     Fc   Pr>Fc\nBloco               3 3409.4  2 6.5107 0.00275\nESPECIE             3 1309.4  5 2.5004 0.08733\nNITROGENIO          1   28.1  4 0.1611 0.69218\nESPECIE*NITROGENIO  3  209.4  6 0.3998 0.75454\nResiduo            21 3665.6  3               \nTotal              31 8621.9  1               \n------------------------------------------------------------------------\nCV = 7.4 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.858878 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis Medias\n1 Aveia Preta 176.25\n2     Centeio 171.25\n3      Pousio 188.75\n4   Triticale 177.50\n------------------------------------------------------------------------\nNITROGENIO\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis  Medias\n1  Com N 177.500\n2  Sem N 179.375\n------------------------------------------------------------------------\n\n\n\nCOMO NÃO DEU DIFERENÇA SIGNIFICATIVA PARA NENHUM FATOR, PODE-SE APENAS APRESENTAR O GRÁFICO, MAS SEM DISCUTIR DIFERENÇAS ENTRE OS TRATAMENTOS/N\n\n\nplot_factbars(df_cobsoja, ESPECIE, NITROGENIO,\n              resp = MMG,\n              y.expand = 0.1,\n              xlab = \"Espécie\",\n              ylab = \"Massa de mil grãos (g)\")\n\n\n\n\n\n\nVariável RG\nANOVA\n\nwith(df_cobsoja,\n     fat2.dbc(fator1 = ESPECIE,\n              fator2 = NITROGENIO,\n              bloco = REP,\n              resp = RG,\n              fac.names = c(\"ESPECIE\", \"NITROGENIO\"))\n)\n\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  ESPECIE \nFATOR 2:  NITROGENIO \n------------------------------------------------------------------------\n\n\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                   GL       SQ QM      Fc   Pr>Fc\nBloco               3  9602221  4 1.97873 0.14806\nESPECIE             3   219192  6 0.04517 0.98689\nNITROGENIO          1   461200  5 0.28512 0.59897\nESPECIE*NITROGENIO  3  3950128  2 0.81400 0.50045\nResiduo            21 33969089  3                \nTotal              31 48201830  1                \n------------------------------------------------------------------------\nCV = 38.68 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.1875762 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nESPECIE\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis   Medias\n1 Aveia Preta 3368.403\n2     Centeio 3305.556\n3      Pousio 3150.000\n4   Triticale 3327.778\n------------------------------------------------------------------------\nNITROGENIO\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n  Niveis   Medias\n1  Com N 3167.882\n2  Sem N 3407.986\n------------------------------------------------------------------------\n\n\n\nCOMO NÃO DEU DIFERENÇA SIGNIFICATIVA PARA NENHUM FATOR, PODE-SE APENAS APRESENTAR O GRÁFICO, MAS SEM DISCUTIR DIFERENÇAS ENTRE OS TRATAMENTOS/N\n\n\nplot_factbars(df_cobsoja, ESPECIE, NITROGENIO,\n              resp = RG,\n              y.expand = 0.1,\n              xlab = \"Espécie\",\n              ylab = \"RG (kg/ha)\")"
  },
  {
    "objectID": "FIT5306/FIT5306_10_FAT.html#doses-de-nitrogênio-x-híbridos-de-milho",
    "href": "FIT5306/FIT5306_10_FAT.html#doses-de-nitrogênio-x-híbridos-de-milho",
    "title": "9. Experimentos Fatoriais",
    "section": "Doses de Nitrogênio x híbridos de milho",
    "text": "Doses de Nitrogênio x híbridos de milho\n\nSem interação significativa\nO conjunto de dados utilizado neste exemplo será o FAT2_SI. Como já de conhecimento prévio, a interação não é significativa neste exemplo.\n\nlibrary(rio) # importar e exportar arquivos\nlibrary(ExpDes.pt) # fazer anova\nlibrary(metan) # gráficos\nlibrary(tidyverse) # manipulação de dados e gráficos\n\n# dados\nurl <- \"https://bit.ly/df_biostat\"\nFAT2_SI <- import(url, sheet = \"FAT2_SI\", setclass = \"tbl\")\nFAT2_SI\n\n# A tibble: 40 × 4\n   BLOCO HIBRIDO DOSEN    RG\n   <dbl> <chr>   <dbl> <dbl>\n 1     1 NUPEC_1     0  6.9 \n 2     1 NUPEC_1    25  7.44\n 3     1 NUPEC_1    50  7.65\n 4     1 NUPEC_1    75  7.5 \n 5     1 NUPEC_1   100  7.03\n 6     1 NUPEC_2     0  6.68\n 7     1 NUPEC_2    25  7.14\n 8     1 NUPEC_2    50  7.26\n 9     1 NUPEC_2    75  7.03\n10     1 NUPEC_2   100  6.69\n# … with 30 more rows\n\n\nA função fat2.rdb()é utilizada neste exemplo. Como o fator DOSEN é quantitativo, precisamos informar isto no argumento quali da função.\n\nwith(FAT2_SI, \n     fat2.dbc(fator1 =  HIBRIDO,\n              fator2 =  DOSEN,\n              bloco = BLOCO,\n              resp =  RG,\n              quali = c(TRUE, FALSE),\n              fac.names = c(\"HIBRIDO\", \"DOSE\")))\n\nComo a interação não foi significativa, proceder-se-a a comparação de médias dos dois híbridos considerando a média de todas as doses de nitrogênio, e o ajuste de apenas uma regressão para os dois híbridos. Como o grau do polinômio significativo foi quadrático, declararmos fit = 2 na função plot_lines() do pacote metan.\n\nh <- plot_bars(FAT2_SI, HIBRIDO, RG,\n               width.bar = 0.5,\n               lab.bar = c(\"a\", \"b\"))\nd <- plot_lines(FAT2_SI, DOSEN, RG,\n                fit = 2,\n                col = FALSE,\n                xlab = \"Doses de nitrogênio\",\n                ylab = \"Rendimento de grãos (Mg/ha)\") +\n  geom_text(aes(0, 6.5, label=(paste(expression(\"y = 6,8326 + 0,0012x - 0,0003x\"^2*\"  R\" ^2*\" = 0,99 \")))),\n            hjust = 0,\n            col = \"black\",\n            parse = TRUE) \narrange_ggplot(h, d, tag_levels = list(c(\"h\", \"d\")), widths = c(1, 3))\n\n\n\n\n\n\n\n\n\n\nCom interação significativa\nO conjunto de dados utilizado neste exemplo será o FAT2_CI. Neste exemplo já sabe-se que a interação híbrido x dose de N é significativa.\n\nlibrary(rio) # importar e exportar arquivos\nlibrary(ExpDes.pt) # fazer anova\nlibrary(metan) # gráficos\nlibrary(tidyverse) # manipulação de dados e gráficos\n\n# dados\nurl <- \"https://bit.ly/df_biostat\"\nFAT2_CI <- import(url, sheet = \"FAT2_CI\", setclass = \"tbl\")\nFAT2_CI\n\n# A tibble: 40 × 4\n   BLOCO HIBRIDO DOSEN    RG\n   <dbl> <chr>   <dbl> <dbl>\n 1     1 NUPEC_1     0 11.2 \n 2     1 NUPEC_1    25 12.4 \n 3     1 NUPEC_1    50 13   \n 4     1 NUPEC_1    75 12.5 \n 5     1 NUPEC_1   100 11.4 \n 6     1 NUPEC_2     0  9.22\n 7     1 NUPEC_2    25  9.70\n 8     1 NUPEC_2    50 10.1 \n 9     1 NUPEC_2    75 10.9 \n10     1 NUPEC_2   100 11.4 \n# … with 30 more rows\n\n\n\nwith(FAT2_CI, \n     fat2.dbc(fator1 =  HIBRIDO,\n              fator2 =  DOSEN,\n              bloco = BLOCO,\n              resp =  RG,\n              quali = c(TRUE, FALSE),\n              fac.names = c(\"HIBRIDO\", \"DOSE\")))\n## ------------------------------------------------------------------------\n## Legenda:\n## FATOR 1:  HIBRIDO \n## FATOR 2:  DOSE \n## ------------------------------------------------------------------------\n## \n## \n## Quadro da analise de variancia\n## ------------------------------------------------------------------------\n##              GL     SQ QM      Fc   Pr>Fc\n## Bloco         3  0.119  3    1.29 0.29725\n## HIBRIDO       1 40.076  6 1306.48 0.00000\n## DOSE          4  8.436  4   68.75 0.00000\n## HIBRIDO*DOSE  4  9.814  5   79.98 0.00000\n## Residuo      27  0.828  2                \n## Total        39 59.272  1                \n## ------------------------------------------------------------------------\n## CV = 1.56 %\n## \n## ------------------------------------------------------------------------\n## Teste de normalidade dos residuos (Shapiro-Wilk)\n## valor-p:  0.03477145 \n## ATENCAO: a 5% de significancia, os residuos nao podem ser considerados normais!\n## ------------------------------------------------------------------------\n## \n## \n## \n## Interacao significativa: desdobrando a interacao\n## ------------------------------------------------------------------------\n## \n## Desdobrando  HIBRIDO  dentro de cada nivel de  DOSE \n## ------------------------------------------------------------------------\n## ------------------------------------------------------------------------\n## Quadro da analise de variancia\n## ------------------------------------------------------------------------\n##                  GL       SQ       QM       Fc  Pr.Fc\n## Bloco             3  0.11891  0.03964   1.2921 0.2972\n## DOSE              4  8.43556  2.10889  68.7499      0\n## HIBRIDO:DOSE 0    1 11.10618 11.10618 362.0622      0\n## HIBRIDO:DOSE 25   1 14.34872 14.34872 467.7692      0\n## HIBRIDO:DOSE 50   1 17.81448 17.81448  580.753      0\n## HIBRIDO:DOSE 75   1  6.55582  6.55582 213.7201      0\n## HIBRIDO:DOSE 100  1  0.06444  0.06444   2.1008 0.1587\n## Residuo          27  0.82822  0.03067                \n## Total            39 59.27234  1.51980                \n## ------------------------------------------------------------------------\n## \n## \n## \n##  HIBRIDO  dentro do nivel  0  de  DOSE \n## ------------------------------------------------------------------------\n## Teste de Tukey\n## ------------------------------------------------------------------------\n## Grupos Tratamentos Medias\n## a     NUPEC_1     11.56 \n##  b    NUPEC_2     9.2035 \n## ------------------------------------------------------------------------\n## \n## \n##  HIBRIDO  dentro do nivel  25  de  DOSE \n## ------------------------------------------------------------------------\n## Teste de Tukey\n## ------------------------------------------------------------------------\n## Grupos Tratamentos Medias\n## a     NUPEC_1     12.595 \n##  b    NUPEC_2     9.9165 \n## ------------------------------------------------------------------------\n## \n## \n##  HIBRIDO  dentro do nivel  50  de  DOSE \n## ------------------------------------------------------------------------\n## Teste de Tukey\n## ------------------------------------------------------------------------\n## Grupos Tratamentos Medias\n## a     NUPEC_1     12.935 \n##  b    NUPEC_2     9.9505 \n## ------------------------------------------------------------------------\n## \n## \n##  HIBRIDO  dentro do nivel  75  de  DOSE \n## ------------------------------------------------------------------------\n## Teste de Tukey\n## ------------------------------------------------------------------------\n## Grupos Tratamentos Medias\n## a     NUPEC_1     12.625 \n##  b    NUPEC_2     10.8145 \n## ------------------------------------------------------------------------\n## \n## \n##  HIBRIDO  dentro do nivel  100  de  DOSE \n## \n## De acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n## ------------------------------------------------------------------------\n##    Niveis  Medias\n## 1 NUPEC_1 11.5465\n## 2 NUPEC_2 11.3670\n## ------------------------------------------------------------------------\n## \n## \n## \n## Desdobrando  DOSE  dentro de cada nivel de  HIBRIDO \n## ------------------------------------------------------------------------\n## ------------------------------------------------------------------------\n## Quadro da analise de variancia\n## ------------------------------------------------------------------------\n##                      GL       SQ       QM        Fc  Pr.Fc\n## Bloco                 3  0.11891  0.03964    1.2921 0.2972\n## HIBRIDO               1 40.07604 40.07604 1306.4809      0\n## DOSE:HIBRIDO NUPEC_1  4  6.79944  1.69986   55.4156      0\n## DOSE:HIBRIDO NUPEC_2  4 11.44973  2.86243   93.3155      0\n## Residuo              27  0.82822  0.03067                 \n## Total                39 59.27234  1.51980                 \n## ------------------------------------------------------------------------\n## \n## \n## \n##  DOSE  dentro do nivel  NUPEC_1  de  HIBRIDO \n## ------------------------------------------------------------------------\n## Ajuste de modelos polinomiais de regressao\n## ------------------------------------------------------------------------\n## \n## Modelo Linear\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0  12.2517     0.0678    180.6175    0   \n## b1  0.00001     0.0011     0.0108  0.9914 \n## ------------------------------------------\n## \n## R2 do modelo linear\n## --------\n## 0.000001\n## --------\n## \n## Analise de variancia do modelo linear\n## ===================================================\n##                      GL   SQ     QM    Fc   valor.p\n## ---------------------------------------------------\n## Efeito linear        1    0      0      0   0.99144\n## Desvios de Regressao 3  6.7994 2.2665 73.89    0   \n## Residuos             27 0.8282 0.0307              \n## ---------------------------------------------------\n## ------------------------------------------------------------------------\n## \n## Modelo quadratico\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0  11.5550     0.0824    140.2044    0   \n## b1   0.0557     0.0039    14.2760     0   \n## b2  -0.0006     0.00004   -14.8843    0   \n## ------------------------------------------\n## \n## R2 do modelo quadratico\n## --------\n## 0.999458\n## --------\n## \n## Analise de variancia do modelo quadratico\n## ====================================================\n##                      GL   SQ     QM     Fc   valor.p\n## ----------------------------------------------------\n## Efeito linear        1    0      0      0    0.99144\n## Efeito quadratico    1  6.7958 6.7958 221.54    0   \n## Desvios de Regressao 2  0.0037 0.0018  0.06  0.94178\n## Residuos             27 0.8282 0.0307               \n## ----------------------------------------------------\n## ------------------------------------------------------------------------\n## \n## Modelo cubico\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0  11.5623     0.0869    132.9870    0   \n## b1   0.0536     0.0088     6.0633     0   \n## b2  -0.0005     0.0002    -2.2190  0.0351 \n## b3 -0.000000       0      -0.2654  0.7927 \n## ------------------------------------------\n## \n## R2 do modelo cubico\n## --------\n## 0.999775\n## --------\n## \n## Analise de variancia do modelo cubico\n## ====================================================\n##                      GL   SQ     QM     Fc   valor.p\n## ----------------------------------------------------\n## Efeito linear        1    0      0      0    0.99144\n## Efeito quadratico    1  6.7958 6.7958 221.54    0   \n## Efeito cubico        1  0.0022 0.0022  0.07  0.79271\n## Desvios de Regressao 1  0.0015 0.0015  0.05  0.82509\n## Residuos             27 0.8282 0.0307               \n## ----------------------------------------------------\n## ------------------------------------------------------------------------\n## \n## \n##  DOSE  dentro do nivel  NUPEC_2  de  HIBRIDO \n## ------------------------------------------------------------------------\n## Ajuste de modelos polinomiais de regressao\n## ------------------------------------------------------------------------\n## \n## Modelo Linear\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0   9.2054     0.0678    135.7082    0   \n## b1   0.0209     0.0011    18.8680     0   \n## ------------------------------------------\n## \n## R2 do modelo linear\n## --------\n## 0.953756\n## --------\n## \n## Analise de variancia do modelo linear\n## ====================================================\n##                      GL   SQ      QM     Fc  valor.p\n## ----------------------------------------------------\n## Efeito linear        1  10.9202 10.9202 356     0   \n## Desvios de Regressao 3  0.5295  0.1765  5.75 0.00354\n## Residuos             27 0.8282  0.0307              \n## ----------------------------------------------------\n## ------------------------------------------------------------------------\n## \n## Modelo quadratico\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0   9.2781     0.0824    112.5776    0   \n## b1   0.0151     0.0039     3.8624  0.0006 \n## b2   0.0001     0.00004    1.5534  0.1320 \n## ------------------------------------------\n## \n## R2 do modelo quadratico\n## --------\n## 0.960221\n## --------\n## \n## Analise de variancia do modelo quadratico\n## ====================================================\n##                      GL   SQ      QM     Fc  valor.p\n## ----------------------------------------------------\n## Efeito linear        1  10.9202 10.9202 356     0   \n## Efeito quadratico    1  0.0740  0.0740  2.41 0.13196\n## Desvios de Regressao 2  0.4555  0.2277  7.42 0.0027 \n## Residuos             27 0.8282  0.0307              \n## ----------------------------------------------------\n## ------------------------------------------------------------------------\n## \n## Modelo cubico\n## ==========================================\n##    Estimativa Erro.padrao    tc    valor.p\n## ------------------------------------------\n## b0   9.2414     0.0869    106.2918    0   \n## b1   0.0256     0.0088     2.8956  0.0074 \n## b2  -0.0002     0.0002    -1.0496  0.3032 \n## b3  0.000002       0       1.3271  0.1956 \n## ------------------------------------------\n## \n## R2 do modelo cubico\n## --------\n## 0.964939\n## --------\n## \n## Analise de variancia do modelo cubico\n## =====================================================\n##                      GL   SQ      QM     Fc   valor.p\n## -----------------------------------------------------\n## Efeito linear        1  10.9202 10.9202  356     0   \n## Efeito quadratico    1  0.0740  0.0740  2.41  0.13196\n## Efeito cubico        1  0.0540  0.0540  1.76  0.1956 \n## Desvios de Regressao 1  0.4014  0.4014  13.09 0.00121\n## Residuos             27 0.8282  0.0307               \n## -----------------------------------------------------\n## ------------------------------------------------------------------------\n\nA análise de indicou efeitos significativos tanto para os efeitos principais, quanto para a interação. Assim, as análises complementares realizadas foram (i) a comparação das médias pelo teste Tukey em cada nível da dose de N; e (ii) uma regressão polinomial ajustada para cada híbrido. Por padrão, o máximo grau do polinômio ajustado é 3 (modelo cúbico).\n\nComparação das médias dos híbridos em cada dose de nitrogênio.\n\nAs comparações de médias são apresentadas como saída da função fat2.dbc() após a análise de variância. Neste momento, utilizaremos a função plot_factbars() pacote metan** para plotar as médias dos híbridos em cada dose de nitrogênio. A apresentação gráfica de resultados, mesmo considerando médias, é uma alternativa interessante à tabela, pois permite uma interpretação mais clara e intuitiva dos resultados.\n\nplot_factbars(FAT2_CI, DOSEN, HIBRIDO,\n              resp = RG,\n              xlab = \"Doses de nitrogênio\",\n              ylab = expression(paste(\"Rendimento de grãos (Mg ha\"^-1,\")\")),\n              palette = \"Greys\",\n              lab.bar = c(\"a\", \"b\", # 0\n                          \"a\", \"b\", # 25\n                          \"a\", \"b\", # 50\n                          \"a\", \"b\", # 75\n                          \"a\", \"a\")) # 100\n\n\n\n\nGráfico das médias dos híbridos em cada dose de nitrogênio.\n\n\n\n\n\nAjuste de regressão para cada híbrido\n\nNo exemplo anterior, apresentamos as médias dos híbridos em cada dose de nitrogênio. Agora, criaremos um gráfico com o grau do polinômio significativo ajustado de cada híbrido. O grau a ser ajustado deve ser identificado na saída da ANOVA . Para fins didáticos apresento as equações que serão utilizadas.\nNUPEC_1: modelo quadrático \\(y = 11,555 + 0,05575\\times x -0,0005574\\times x^2, R^2 = 0.999\\)\nNUPEC_2: modelo linear \\(y = 9,2054 + 0,0209\\times x, R^2 = 0.986\\)\nUtilizando uma equação, é possível estimar a produtividade para uma dose de nitrogênio específica não testada, desde que ela esteja dentro do intervalo estudado. Para isto, basta substituir o x na equação pela dose a ser testada. Por exemplo, para estimar qual seria a produtividade do híbrido NUPEC_2 se tivéssemos aplicado 60 kg de N ha\\(^{-1}\\) basta resolver: \\(y = 9,2054 + 0,0209\\times 60\\), resultando em \\(y \\approx 10.5\\) Mg ha\\(^{-1}\\). A interpretação deste resultado, no entanto, deve ser cautelosa. Inconscientemente, concluiríamos que a produtividade do híbrido aumentaria 0,0209 Mg ha\\(^{-1}\\) a cada kg de nitrogênio aplicado por hectare. Este fato, no entanto, não é observado na prática. Por exemplo, a produtividade não irá aumentar infinitamente a medida em que se aumenta a dose de nitrogênio aplicado. A única conclusão válida, neste caso, é que a produtividade aumenta linearmente até 100 kg de N ha\\(^{-1}\\). Este resultado se deu em virtude de as doses testadas não terem sido o suficiente para identificar um outro comportamento na variável testada. Nestes casos, indica-se para estudos futuros aumentar o número de doses. Quando não se conhece o intervalo de dose em que a variável em estudo apresenta uma resposta explicável, estudos pilotos podem ser realizados. Neste caso, testar-se-iam o mesmo número de tratamentos (número de doses), no entanto com um intervalo maior entre as doses (por exemplo, 0, 100, 200, 300 e 400 kg de N ha\\(^{-1}\\). Possivelmente, nesta amplitude, o comportamento da produtividade não seria linear, pois em uma determinada dose, a produtividade estabilizaria.\nO ponto em X (dose) em que a produtividade é máxima é chamado de máxima eficiência técnica (MET) e pode ser estimado por:\n\\[\nMET = \\frac{{ - {\\beta _1}}}{{2 \\times {\\beta _2}}}\n\\]\nSubstituindo com os parâmetros estimados, temos:\n\\[\nMET = \\frac{{ - 0,05575}}{{2 \\times  -0,0005574}} = 50\n\\]\n\nx_met <- -0.05575 / (2 * -0.0005574)\nx_met\n\n[1] 50.00897\n\n\nLogo, a dose que proporciona a máxima produtividade para o híbrido NUPEC_1 é aproximadamente 50 kg de N ha\\(^{-1}\\). Assim para sabermos qual é esta produtividade estimada, basta substituir o x da equação por 50, resultando em \\(y_{máx}\\) = 12,949 Mg ha\\(^{-1}\\).\n\ny_met <- 11.555 + 0.05575 * 50 - 0.0005574 * 50^2\n\nOutro ponto importante que é possível de estimar utilizando uma equação de segundo grau, é a máxima eficiência econômica (MEE), ou seja, a dose máxima, neste caso de nitrogênio, em que é possível aplicar obtendo-se lucro. Este ponto é importante, pois a partir de uma certa dose, os incrementos em produtividade não compensariam o preço pago pelo nitrogênio aplicado. Este ponto pode ser facilmente estimado por:\n\\[\nMEE = MET + \\frac{u}{{2 \\times \\beta_2 \\times m}}\n\\]\nonde u e m são os preços do nitrogênio e do milho em grão, respectivamente, na mesma unidade utilizada para a estimativa da equação (neste caso, preço do nitrogênio por kg e preço do milho por tonelada). Considerando o preço de custo do nitrogênio como R$ 5,00 por kg e o preço de venda do milho a R$ 1300,00 por tonelada, substituindo-se na formula obtém-se:\n\\[\nMEE = 50 + \\frac{{5}}{{2 \\times (-0,0005574) \\times 1300}} \\approx 46\n\\]\nAssim, a dose máxima de nitrogênio que em que os incrementos de produtividade são lucrativos é de \\(\\approx 48\\) Kg ha\\(^{-1}\\).\n\nx_mee <- x_met + (5 / (2 * -0.0005574 * 1300))\nx_mee\n\n[1] 46.55889\n\n# predito na mee\n\ny_mee <- 11.555 + 0.05575 * x_mee - 0.0005574 * x_mee^2\ny_mee\n\n[1] 12.94237\n\n\nSemelhante ao exemplo das médias nas doses de nitrogênio, utilizaremos a função plot_factlines() para plotar, agora, uma regressão ajustada para cada híbrido. Os argumentos a serem informados são os seguintes: .data, o conjunto de dados (neste caso FAT2_CI); x e y, as colunas dos dados correspondentes aos eixos x e y do gráfico, respectivamente; group a coluna que contém os níveis dos fatores em que as regressões serão ajustadas; fit um vetor de comprimento igual ao número de níveis da coluna informada em group. O número indicado em cada posição do vetor, corresponde ao grau do polinômio ajustado (máximo grau ajustado = 4). Em nosso exemplo, utilizaremos fit = c(2, 1) para ajustar uma regressão quadrática para o híbrido NUPEC_1 e uma regressão linear para o híbrido NUPEC_2.\n\nplot_factlines(FAT2_CI, DOSEN, RG,\n               group = HIBRIDO,\n               fit = c(2, 1)) +\n  # Linhas e ponto da MET\n  geom_segment(aes(x = x_met,\n                   y = y_met,\n                   xend = x_met,\n                   yend = 8.5),\n               color = \"black\",\n               show.legend = FALSE) +\n  geom_segment(aes(x = 0,\n                   y = y_met,\n                   xend = x_met,\n                   yend = y_met),\n               color = \"black\",\n               show.legend = FALSE) +\n  geom_point(aes(x = x_met, y = y_met), shape = 19, size = 3, color = \"blue\") +\n  # Linhas e ponto da MEE\n  geom_segment(aes(x = x_mee,\n                   y = y_mee,\n                   xend = x_mee,\n                   yend = 8.5),\n               linetype = 2,\n               color = \"black\",\n               show.legend = FALSE) +\n  geom_segment(aes(x = 0,\n                   y = y_mee,\n                   xend = x_mee,\n                   yend = y_mee),\n               linetype = 2,\n               color = \"black\",\n               show.legend = FALSE) +\n  geom_point(aes(x = x_mee, y = y_mee), shape = 17, size = 3, color = \"blue\") +\n  # Equações no gráfico\n  geom_text(aes(0, 11,\n                label=(\n                  paste(\n                    expression(\"y = 11.555 + 0.05575x - 0.0005574x\"^2*\"  R\" ^2*\" = 0,999\"))\n                )\n  ),\n  hjust = 0,\n  size = 5,\n  col = \"black\",\n  parse = TRUE) + \n  geom_text(aes(0, 8.5,\n                label=(\n                  paste(\n                    expression(\"y = 9.2054 + 0.0209x R\" ^2*\" = 0,95\"))\n                )\n  ),\n  hjust = 0,\n  size = 5,\n  col = \"black\",\n  parse = TRUE) \n\n\n\n\nObservando-se a figura acima, é possível identificar o comportamento quadrático da variável resposta do híbrido NUPEC_1. Para este híbrido, houve um incremento positivo na produtividade até um ponto, posteriormente observa-se que a produtividade tendeu a reduzir. Uma explicação biológica para esta redução seria que o excesso de nitrogênio aplicado proporcionou um alto vigor vegetativo as plantas, podendo ter ocorrido competição entre as plantas por água, luz e outros nutrientes, ou até mesmo tombamento das plantas."
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html",
    "href": "FIT5306/FIT5306_11_REG.html",
    "title": "11. Regressão e correlação",
    "section": "",
    "text": "library(tidyverse)\nlibrary(metan)      # estatísticas descritivas\nlibrary(rio)        # importação/exportação de dados\nlibrary(AgroR)\nlibrary(broom)"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#introdução",
    "href": "FIT5306/FIT5306_11_REG.html#introdução",
    "title": "11. Regressão e correlação",
    "section": "Introdução",
    "text": "Introdução\nA análise de regressão tem como objetivo verificar como uma variável independente (x) influencia a resposta de uma variável dependente (y). A análise de regressão é amplamente utilizada nas ciências agrárias. O modelo mais simples de regressão linear é a de primeiro grau, descrita conforme o modelo a seguir:\n\\[\nY_i = {\\beta _0} + {\\beta _1}x + \\varepsilon_i  \n\\]\nOnde \\(Y_i\\) é o valor observado da variável dependente no i-ésimo nível da variável independente; \\(x_i\\) é o valor do i-ésimo nível da variável independente, \\(\\beta_0\\) é o intercepto (valor que a reta predita intercepta o eixo y quando x é igual a zero); \\(\\beta_1\\) é a inclinação da reta (quantas unidades mudam em y a cada unidade alterada em x) e \\(\\varepsilon\\) é o desvio."
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#o-problema",
    "href": "FIT5306/FIT5306_11_REG.html#o-problema",
    "title": "11. Regressão e correlação",
    "section": "O problema",
    "text": "O problema\n\n\n\n\n\n\nNote\n\n\n\nNo seguinte exemplo é apresentado o valor do rendimento de grãos de um certo híbrido de milho (eixo y) em função da dose de N (eixo x).\n\nx <- seq(0, 150, by = 25)\ny <- c(8.6, 8.9, 9.5, 9.9, 10, 10.2, 10.5)\ndf <- data.frame(x = x, y = y)\n\n# plotar os valores\nggplot(df, aes(x, y)) +\n  geom_point(size = 4, color = \"red\") + \n  geom_smooth(se = FALSE, method = \"lm\") +\n  scale_x_continuous(breaks = x) +\n  labs(x = \"Dose de N (Kg/ha)\",\n       y= \"Rendimento de grãos (t/ha)\")\n\n`geom_smooth()` using formula 'y ~ x'\n\n\n\n\n\nO problema consiste em obter o valor de \\(\\beta_0\\) e \\(\\beta_1\\) de melhor ajuste para a equação, de modo que a soma de quadrado dos desvios (diferença entre os pontos observados e a reta de predição) seja mínima. Assim, adota-se o critério de obter a solução que minimiza soma dos quadrados dos resídulos (\\(\\sum\\nolimits_{i = 1}^n {{e_i}^2}\\)), método conhecido como Método dos Mínimos Quadrados\n\\[\n{b_1} = \\frac{{S{P_{xy}}}}{{S{Q_x}}}\n\\]\n\n\n\n\n\n\n\n\nNote\n\n\n\n\\[\n{b_0} = \\bar y - {b_1} \\times \\bar x\n\\]\n\n\n\n\n\n\n\n\nNote\n\n\n\nOnde\n\\[\nS{P_{xy}} = \\sum\\limits_{i = 1}^n {{x_i}{y_i}}  - \\frac{{\\left( {\\sum\\limits_{i = 1}^n {{x_i}} } \\right)\\left( {\\sum\\limits_{i = 1}^n {{y_i}} } \\right)}}{n}\n\\tag{1}\\]\n\\[\n\\\\S{Q_x} = \\sum\\limits_{i = 1}^n {x_i^2}  - \\frac{{{{\\left( {\\sum\\limits_{i = 1}^n {x_i^{}} } \\right)}^2}}}{n}\n\\tag{2}\\]\n\\[\n\\\\S{Q_y} = \\sum\\limits_{i = 1}^n {y_i^2}  - \\frac{{{{\\left( {\\sum\\limits_{i = 1}^n {y_i^{}} } \\right)}^2}}}{n}\n\\tag{3}\\]\nDe posse deste valor pode ser obtidas as somas de quadrados:\n\\[\nS{Q_{total}} = S{Q_y}\n\\]\n\\[\nS{Q_{reg}} = \\frac{{S{P_{xy}}^2}}{{S{Q_x}}}\n\\]\n\\[\nS{Q_{erro}} = S{Q_{total}} - S{Q_{reg}}\n\\]"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#estimação-dos-coeficientes",
    "href": "FIT5306/FIT5306_11_REG.html#estimação-dos-coeficientes",
    "title": "11. Regressão e correlação",
    "section": "Estimação dos coeficientes",
    "text": "Estimação dos coeficientes\nNo seguinte exemplo, são calculados as somas de x e y, as somas de \\(x^2\\) e \\(y^2\\) e também as somas de \\(x\\times y\\) .\n\ndf2 <- \n  mutate(df,\n         x2 = x ^ 2,\n         y2 = y ^ 2,\n         xy = x * y)\ndf2\n\n    x    y    x2     y2     xy\n1   0  8.6     0  73.96    0.0\n2  25  8.9   625  79.21  222.5\n3  50  9.5  2500  90.25  475.0\n4  75  9.9  5625  98.01  742.5\n5 100 10.0 10000 100.00 1000.0\n6 125 10.2 15625 104.04 1275.0\n7 150 10.5 22500 110.25 1575.0\n\n# número de pontos\n(n <- length(x))\n\n[1] 7\n\n# soma de xi\n(sum_xi <- sum(x))\n\n[1] 525\n\n# soma de xi ao quadrado\n(sum_xi2 <- sum(x ^ 2))\n\n[1] 56875\n\n# soma de yi\n(sum_yi <- sum(y))\n\n[1] 67.6\n\n# soma de yi ao quadrado\n(sum_yi2 <- sum(y ^ 2))\n\n[1] 655.72\n\n# soma de xi * yi\n(sum_xiyi <- sum(x * y))\n\n[1] 5290\n\n\nNote que estas mesmas somas podem ser obtidas facilmente utilizando duas outras abordagens. A primeira usando a função colSums() e outra a função apply().\n\ncolSums(df2)\n\n       x        y       x2       y2       xy \n  525.00    67.60 56875.00   655.72  5290.00 \n\napply(df2, 2, sum)\n\n       x        y       x2       y2       xy \n  525.00    67.60 56875.00   655.72  5290.00 \n\n\nDe posse destes valores é possível computar a soma de produtos de x e y , bem como suas somas de quadrados.\n\n# soma de produtos de X e Y\n(SPxy <- sum_xiyi - (sum_xi * sum_yi) / n)\n\n[1] 220\n\n# soma de quadrados de X\n(SQx <- sum_xi2 - (sum_xi ^2) / n)\n\n[1] 17500\n\n# soma de quadrados de Y\n(SQy <- sum_yi2 - (sum_yi ^ 2) / n)\n\n[1] 2.897143\n\n# computar o b1\n(b1 <- SPxy / SQx)\n\n[1] 0.01257143\n\n# computar o b0\n(b0 <- mean(y) - b1 * mean(x))\n\n[1] 8.714286"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#regressão-ajustada-e-tabela-anova",
    "href": "FIT5306/FIT5306_11_REG.html#regressão-ajustada-e-tabela-anova",
    "title": "11. Regressão e correlação",
    "section": "Regressão ajustada e tabela ANOVA",
    "text": "Regressão ajustada e tabela ANOVA\nA equação ajustada é então \\(y = 8,7142 + 0,01257x\\). As somas de quadrados de regressão e resídulo são dadas à seguir\n\n# soma de quadrado total\n(SQtot <- SQy)\n\n[1] 2.897143\n\n(SQreg <- SPxy ^ 2 / SQx)\n\n[1] 2.765714\n\n(SQerro <- SQtot - SQreg)\n\n[1] 0.1314286\n\n\nPode-se ainda obter a análise da variância da regressão, cujo esquema é apresentado a seguir na Tabela.\n\nFV <- c(\"Regressão\", \"Desvio\", \"Total\")\nGL <- c(1, n - 2, n - 1)\nSQ <- c(SQreg, SQerro, SQtot)\nQM <- SQ / GL\nFC <- c(QM[[1]] / QM[[3]], NA, NA)\ndata.frame(FV, GL, SQ, QM, FC) |> knitr::kable()\n\n\n\n\nFV\nGL\nSQ\nQM\nFC\n\n\n\n\nRegressão\n1\n2.7657143\n2.7657143\n5.727811\n\n\nDesvio\n5\n0.1314286\n0.0262857\nNA\n\n\nTotal\n6\n2.8971429\n0.4828571\nNA"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#grau-de-ajuste-do-modelo",
    "href": "FIT5306/FIT5306_11_REG.html#grau-de-ajuste-do-modelo",
    "title": "11. Regressão e correlação",
    "section": "Grau de ajuste do modelo",
    "text": "Grau de ajuste do modelo\nA proporção da variação de y que é explicada pelos níveis de x é conhecido como coeficiente de determinação (\\(R^2\\)) e é calculado por:\n\\[\nR^2 = \\frac{SQ_{reg}}{SQ_{tot}}\n\\]\n\n(R2 <- SQreg / SQtot)\n\n[1] 0.9546351\n\n\nPode-se ainda obter o (\\(R^2\\)) ajustado (\\(R^2_{adj}\\)) . O \\(R^2_{adj}\\) pode ser usado quando desejar comparar modelos que têm diferentes números de preditores. O (\\(R^2\\)) sempre aumenta quando você adiciona um preditor ao modelo, mesmo quando não existe uma verdadeira melhoria ao modelo. O valor de (\\(R^2_{adj}\\)) ajustado o número de preditores no modelo para ajudá-lo a escolher o modelo correto1, sendo calculado por:\n\\[\nR^2_{adj} = 1 -\\frac{(n - 1)(1 -  R^2)}{n - p}\n\\] Sendo que para a regressão linear simples estima-se 2 parâmetros (\\(\\beta_0\\) e \\(\\beta_1\\)).\n\nR2adj <- 1 - ((n - 1)*(1 - R2)) / (n - 2)\nR2adj\n\n[1] 0.9455621"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#valores-preditos-e-resíduos",
    "href": "FIT5306/FIT5306_11_REG.html#valores-preditos-e-resíduos",
    "title": "11. Regressão e correlação",
    "section": "Valores preditos e resíduos",
    "text": "Valores preditos e resíduos\nOs valores preditos são obtidos substituindo-se o x da equação pelo valor de x testado. Como o R trabalha de forma vetorizada, podemos facilmente obter os valores preditos para cada elemento de x com:\n\n(pred <- b0 + b1 * x)\n\n[1]  8.714286  9.028571  9.342857  9.657143  9.971429 10.285714 10.600000\n\n\nOs desvios são computados como a diferença entre o valor observado e o valor predito. Assim, pode calculá-los com:\n\n(desvios <- y - pred)\n\n[1] -0.11428571 -0.12857143  0.15714286  0.24285714  0.02857143 -0.08571429\n[7] -0.10000000\n\n\nFica fácil identificar estes desvios plotando-os no gráfico abaixo.\n\n# gráfico base\nggplot(df, aes(x, y)) +\n  geom_segment(aes(x = x,\n                   y = y,\n                   xend = x,\n                   yend = pred)) +\n  geom_point(size = 4, color = \"red\") + \n  geom_smooth(se = FALSE, method = \"lm\") +\n  scale_x_continuous(breaks = x) +\n  labs(x = \"Dose de N (Kg/ha)\",\n       y= \"Rendimento de grãos (t/ha)\")\n\n`geom_smooth()` using formula 'y ~ x'\n\n\n\n\n\nA soma de quadrado dos desvios obtida anteriormente pode ser obtida aqui também, ao somarmos o quadrado dos desvios.\n\nsum(desvios ^ 2)\n\n[1] 0.1314286"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#a-função-lm",
    "href": "FIT5306/FIT5306_11_REG.html#a-função-lm",
    "title": "11. Regressão e correlação",
    "section": "A função lm()",
    "text": "A função lm()\nNo R, a função lm() (linear model) pode ser utilizada para ajustar a equação linear. Para isso, utiliza-se uma fórmula to tipo y ~ x (ou seja, y em função de x). Note que y e x são os nomes das variáveis presentes no data frame, informado no argumento data.\n\n# ajustar modelo de regressão linear\nmod <- lm(y ~ x, data = df)\n\n# coeficientes\nsummary(mod)\n\n\nCall:\nlm(formula = y ~ x, data = df)\n\nResiduals:\n       1        2        3        4        5        6        7 \n-0.11429 -0.12857  0.15714  0.24286  0.02857 -0.08571 -0.10000 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 8.714286   0.110472   78.88  6.2e-09 ***\nx           0.012571   0.001226   10.26 0.000151 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1621 on 5 degrees of freedom\nMultiple R-squared:  0.9546,    Adjusted R-squared:  0.9456 \nF-statistic: 105.2 on 1 and 5 DF,  p-value: 0.0001513\n\n# Análise de variância\nanova(mod)\n\nAnalysis of Variance Table\n\nResponse: y\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nx          1 2.76571 2.76571  105.22 0.0001513 ***\nResiduals  5 0.13143 0.02629                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n\n\n\nConferindo os resultados\n\n\n\nCompare os valores obtidos no cálculo passo-a-passo com os valores dos coeficientes obtidos com a função summary(mod) e anova(mod). Os valores conferem?\n\n\nNo código abaixo é criado um novo conjunto de dados, contendo os valores preditos e os resíduos.\n\n# valores preditos\npred <- \n  df %>% \n  mutate(predito = predict(mod),\n         residual = y - predito)\npred\n\n    x    y   predito    residual\n1   0  8.6  8.714286 -0.11428571\n2  25  8.9  9.028571 -0.12857143\n3  50  9.5  9.342857  0.15714286\n4  75  9.9  9.657143  0.24285714\n5 100 10.0  9.971429  0.02857143\n6 125 10.2 10.285714 -0.08571429\n7 150 10.5 10.600000 -0.10000000\n\n\nOs valores preditos são obtidos ao substituir o x da equação pelo valor utilizado. Pode-se criar uma função para retornar os valores preditos utilizando um modelo ajustado e o valor de x desejado. No seguinte exemplo, o valor de y quando x é 75 é calculado e plotado no gráfico.\n\n# modelo ajustado o valor predito para x = 75\n# função auxiliar\npred_linear <- function(mod, x){\n  b0 <- coef(mod)[[1]]\n  b1 <- coef(mod)[[2]]\n  pred <- b0 + b1 * x\n  return(pred)\n}\n\npred_75 <- pred_linear(mod, 75)\npred_75\n\n[1] 9.657143\n\nggplot(df, aes(x, y)) +\n  geom_smooth(se = FALSE, method = \"lm\") +\n  geom_segment(aes(x = 75, y = 8.5, xend = 75, yend = pred_75)) +\n  geom_segment(aes(x = 0, y = pred_75, xend = 75, yend = pred_75)) +\n  geom_point(aes(x = 75, y = pred_75), color = \"blue\", size = 4) +\n  geom_point(size = 4, color = \"red\") + \n  scale_x_continuous(breaks = x) +\n  labs(x = \"Dose de N (Kg/ha)\",\n       y= \"Rendimento de grãos (t/ha)\",\n       title = \"Reta predita para o modelo de regressão\",\n       subtitle = \"O ponto azul representa o RG predito com 75 kg/ha de N\")\n\n`geom_smooth()` using formula 'y ~ x'"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#regressão-linear-com-repetições",
    "href": "FIT5306/FIT5306_11_REG.html#regressão-linear-com-repetições",
    "title": "11. Regressão e correlação",
    "section": "Regressão linear com repetições",
    "text": "Regressão linear com repetições\n\nurl <- \"https://bit.ly/df_biostat\"\ndf_reg <- import(url, sheet = \"REG_DEL_DATA\", setclass = \"tbl\")\n\n\n# anova em DBC\ndf_factors <- df_reg %>% as_factor(1:2)\nanova <- aov(RG ~ DOSEN + BLOCO, data = df_factors)\ntidy(anova) %>% as.data.frame()\n\n       term df      sumsq     meansq statistic      p.value\n1     DOSEN  4 14.8617548 3.71543870  116.2335 1.737670e-09\n2     BLOCO  3  0.1568282 0.05227605    1.6354 2.333476e-01\n3 Residuals 12  0.3835836 0.03196530        NA           NA\n\n# regressão\nreg <- lm(RG ~ DOSEN, data = df_reg)\ntidy(reg) %>% as.data.frame()\n\n         term estimate   std.error statistic      p.value\n1 (Intercept) 8.434550 0.078237590 107.80687 9.383071e-27\n2       DOSEN 0.024222 0.001277614  18.95877 2.419233e-13\n\n# anova da regressão\nanova_reg <- aov(reg)\ntidy(anova_reg) %>% as.data.frame() %>% slice(1)\n\n   term df    sumsq   meansq statistic      p.value\n1 DOSEN  1 14.66763 14.66763   359.435 2.419233e-13\n\n# pontos plotados\nggplot(df_reg, aes(DOSEN, RG)) +\n  geom_point(color = \"red\") +\n  stat_summary(geom = \"point\",\n               fun = mean,\n               shape = 23) +\n  labs(x = \"Dose de N (Kg/ha)\",\n       y = \"Rendimento de grãos (t/ha)\") +\n  geom_smooth(method = \"lm\", se = FALSE)\n\n`geom_smooth()` using formula 'y ~ x'"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#polinômio-de-segundo-grau",
    "href": "FIT5306/FIT5306_11_REG.html#polinômio-de-segundo-grau",
    "title": "11. Regressão e correlação",
    "section": "Polinômio de segundo grau",
    "text": "Polinômio de segundo grau\nA regressão polinomial de segundo grau (que também é linear!) é uma outra opção muito útil para analisar dados que apresentem comportamento de parábola, por vezes observado em ensaios que testam dosagens de algum produto/fertilizante, etc. Neste tipo, um parâmetro a mais é adicionado ao modelo, ficando na forma:\n\\[\nY_i = {\\beta _0} + {\\beta _1}x + {\\beta _2}x^2 + \\varepsilon_i  \n\\]\nComo motivação, utilizaremos os dados abaixo. Para ajustar um modelo polinomial, utilizamos a função poly() e informamos o grau do polinômio desejado. É válido lembrar, que o grau máximo possível de polinômio é dado pelo número de níveis da variável independente/preditora menos 1.\n\nDOSEN <- c(0, 50, 100, 150, 200, 250)\nRG    <- c(7.1, 7.3, 7.66, 7.71, 7.62, 7.6)\ndf2 <- data.frame(DOSEN = DOSEN, RG = RG)\n\n# modelo de regressão\nmod2 <- lm(RG ~ poly(DOSEN, 2, raw = TRUE), data = df2)\nsummary(mod2)\n\n\nCall:\nlm(formula = RG ~ poly(DOSEN, 2, raw = TRUE), data = df2)\n\nResiduals:\n       1        2        3        4        5        6 \n 0.02500 -0.08243  0.07371  0.02343 -0.06329  0.02357 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  7.075e+00  7.013e-02 100.882 2.15e-06 ***\npoly(DOSEN, 2, raw = TRUE)1  7.184e-03  1.319e-03   5.445   0.0122 *  \npoly(DOSEN, 2, raw = TRUE)2 -2.071e-05  5.066e-06  -4.089   0.0264 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.07738 on 3 degrees of freedom\nMultiple R-squared:  0.9389,    Adjusted R-squared:  0.8982 \nF-statistic: 23.06 on 2 and 3 DF,  p-value: 0.0151\n\n# valores preditos\npred2 <- \n  df2 %>% \n  mutate(predito = predict(mod2),\n         residual = RG - predito)\npred2\n\n  DOSEN   RG  predito    residual\n1     0 7.10 7.075000  0.02500000\n2    50 7.30 7.382429 -0.08242857\n3   100 7.66 7.586286  0.07371429\n4   150 7.71 7.686571  0.02342857\n5   200 7.62 7.683286 -0.06328571\n6   250 7.60 7.576429  0.02357143\n\n# gráfico base\np1 <-\n  ggplot(df2, aes(DOSEN, RG)) +\n  geom_point(size = 4, color = \"red\") + \n  geom_smooth(se = FALSE,\n              method = \"lm\",\n              formula = y ~ poly(x, 2)) +\n  scale_x_continuous(breaks = DOSEN) +\n  labs(x = \"Dose de N (Kg/ha)\",\n       y = \"Rendimento de grãos (t/ha)\")\np1\n\n\n\n\nO ponto em X (dose de N) em que a produtividade é máxima é chamado de máxima eficiência técnica (MET) e pode ser estimado por:\n\\[\nMET = \\frac{{ - {\\beta _1}}}{{2 \\times {\\beta _2}}}\n\\]\nSubstituindo com os parâmetros estimados, temos:\n\\[\nMET = \\frac{{ - 0,007184}}{{2 \\times  -2,071^{-05}}} \\approx 173,4\n\\]\nNo R, podemos criar uma função auxiliar para calcular o ponto de MET.\n\n# máxima eficiência técnica\n# mod é o modelo quadrático ajustado\nmet <- function(mod){\n  b1 <- coef(mod)[[2]]\n  b2 <- coef(mod)[[3]]\n  res <- -b1 / (2 * b2)\n  return(res)\n}\n\nx_met <- met(mod2)\nx_met\n\n[1] 173.4138\n\n\nEm nosso exemplo, o ponto em x (dose de N) que proporciona o máximo rendimento predito é 173,413. Assim para sabermos qual é este rendimento estimado, basta substituir o x da equação por 173,4: \\(y = 7,075 + 0,007184\\times 173,413 -2,071^{-05}\\times 173,413^2 \\approx 7,70\\)\nUma função auxiliar para predição de y em um determinado valor de x considerando um modelo quadrático ajustado é fornecida abaixo.\n\n# valor predito para x = MET\n# função auxiliar\npred_quad <- function(mod, x){\n  b0 <- coef(mod)[[1]]\n  b1 <- coef(mod)[[2]]\n  b2 <- coef(mod)[[3]]\n  pred <- b0 + b1 * x + b2 * x ^ 2\n  return(pred)\n}\npred_met <- pred_quad(mod2, x = x_met)\npred_met\n\n[1] 7.697927\n\n\nOutro ponto importante que é possível de estimar utilizando uma equação de segundo grau, é a máxima eficiência econômica (MEE), ou seja, a dose máxima, neste caso de nitrogênio, em que é possível aplicar obtendo-se lucro. Este ponto é importante, pois a partir de uma certa dose, os incrementos em produtividade não compensariam o preço pago pelo nitrogênio aplicado. Este ponto pode ser facilmente estimado por:\n\\[\nMEE = MET + \\frac{u}{{2 \\times \\beta_2 \\times m}}\n\\]\nonde u e m são os preços do nitrogênio e do milho em grão, respectivamente, na mesma unidade utilizada para a estimativa da equação (neste caso, preço do nitrogênio por kg e preço do milho por tonelada). Considerando o preço de custo do nitrogênio como R 3 por kg e o preço de venda do milho a 1,300 por tonelada, substituindo-se na formula obtêm-se:\n\\[\nMEE = 173,41 + \\frac{{3,0}}{{2 \\times (-2,071^{-05}) \\times 1.300}} \\approx 117\n\\]\n\nmee <- function(mod, px, py){\n  x_met <- met(mod)\n  mee <- x_met + px / (2 * coef(mod)[[3]] * py)\n  return(mee)\n}\n\nx_mee <- mee(mod2, 3, 1300)\nx_mee\n\n[1] 117.7109\n\n\nAssim, a dose máxima de nitrogênio que em que os incrementos de produtividade são lucrativos é de \\(\\approx 117\\) Kg ha\\(^{-1}\\), em um rendimento estimado de \\(\\approx\\) 7,63 Mg ha\\(^{-1}\\).\n\n# Máxima eficiência econõmica (y)\nrg_mee <- pred_quad(mod2, x = x_mee)\nrg_mee\n\n[1] 7.633655\n\n\nDe posse das informações, um gráfico elaborado, que deveria ser apresentado em todo trabalho deste tipo pode ser confeccionado com a função plot_lines() do pacote metan combinado com algumas funções do pacote ggplot2. Sugiro a leitura do capítulo 8 deste material para mais informações sobre confecção de gráficos no R.\n\np1 +\n  labs(title = \"Equação quadrática\",\n       subtitle = \"Trigângulo e cículo representam os pontos de MME e MET, respectivamente\",\n       caption = \"MME = Máxima eficiência econômica\\n MET = máxima eficiência técnica\") +\n  # Linhas e ponto da MET\n  geom_segment(aes(x = x_met, y = pred_met, xend = x_met, yend = 6.7)) +\n  geom_segment(aes(x = 0, y = pred_met, xend = x_met, yend = pred_met)) +\n  geom_point(aes(x = x_met, y = pred_met), shape = 19, size = 3, color = \"blue\") +\n  # Linhas e ponto da MEE\n  geom_segment(aes(x = x_mee, y = rg_mee, xend = x_mee, yend = 6.7), linetype = 2) +\n  geom_segment(aes(x = 0, y = rg_mee, xend = x_mee, yend = rg_mee), linetype = 2) +\n  geom_point(aes(x = x_mee, y = rg_mee), shape = 17, size = 3, color = \"blue\") +\n  # Equação no gráfico\n  geom_text(aes(0, 7.9,\n                label=(\n                  paste(\n                    expression(\"y = 7.075 + 0.007184x - 2,071e\"^{-5}*\"x\"^2*\"  R\" ^2*\" = 0,938 \"))\n                )\n  ),\n  hjust = 0,\n  size = 5,\n  col = \"black\",\n  parse = TRUE)"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#exercício",
    "href": "FIT5306/FIT5306_11_REG.html#exercício",
    "title": "11. Regressão e correlação",
    "section": "Exercício",
    "text": "Exercício\n\nDados\n\nNeste exemplo, serão utilizados dados de produtividade de grãos de milho (Kg /ha) de acordo com diferentes doses de dejeto suíno (m3/ha) aplicadas na cultura do milho2.\n\n\nurl <- \"https://bit.ly/df_biostat\"\nreg_ex <- import(url, sheet = \"REG_EXERCICIO\", setclass = \"tbl\")\nreg_ex\n\n# A tibble: 4 × 2\n   DOSE    RG\n  <dbl> <dbl>\n1    20  7.09\n2    30  7.37\n3    40  8.28\n4    50  8.32\n\n\n\n\nCálculo dos coeficientes (manual)\n\nAjuste o modelo de regressão linear da forma \\(y_i = \\beta_0 + \\beta_1x_i\\), apresentando o valor dos parâmetros \\(\\beta_0\\) e \\(\\beta_1\\).\n\n\n(x <- reg_ex$DOSE)\n\n[1] 20 30 40 50\n\n(y <- reg_ex$RG)\n\n[1] 7.09 7.37 8.28 8.32\n\n# número de pontos\n(n <- length(x))\n\n[1] 4\n\n# médias\n(mx <- mean(x))\n\n[1] 35\n\n(my <- mean(y))\n\n[1] 7.765\n\n# soma de x\n(sumx <- sum(x))\n\n[1] 140\n\n# soma de y\n(sumy <- sum(y))\n\n[1] 31.06\n\n# soma de x * y\n(sumxy <- sum(x * y))\n\n[1] 1110.1\n\n# soma de x ao quadrado\n(sumx2 <- sum(x ^ 2))\n\n[1] 5400\n\n# soma de y ao quadrado\n(sumy2 <- sum(y ^ 2))\n\n[1] 242.3658\n\n# soma de produtos xy (SPxy)\n(SPxy <- sumxy - (sumx * sumy / n))\n\n[1] 23\n\n# soma de quadrados de x SQx\n(SQx <- sumx2 - sumx ^ 2 / n)\n\n[1] 500\n\n# soma de quadrados de y\n(SQy <- sumy2 - sumy ^ 2 / n)\n\n[1] 1.1849\n\n## coeficientes\n# b1\n(b1 <- SPxy / SQx)\n\n[1] 0.046\n\n# b0\n(b0 <- my - mx * b1)\n\n[1] 6.155\n\n# equação: y = 6150 + 6,15x\n\n\nInterprete o valor dos coeficientes, indicando sua aplicação prática.\n\n\n\n\n\n\n\nInterpretação dos coeficientes\n\n\n\nO intercept indica ….\no coeficiente angular…\n\n\n\nCalcule o valor do coeficiente de determinação (R2) do modelo ajustado e interprete os resultados\n\n\n################## SOMAS DE QUADRADOS DA REGRESSÃO E R2 ############\n\n# soma de quadrado total\n(SQtot <- SQy)\n\n[1] 1.1849\n\n# soma de quadrados da regressão\n(SQreg <- SPxy ^ 2 / (SQx))\n\n[1] 1.058\n\n# soma de quadrados do resíduo\n(SQres <- SQtot - SQreg)\n\n[1] 0.1269\n\n# coeficiente de determinação\n(R2 <- SQreg / SQtot)\n\n[1] 0.8929024\n\n\n\nRealize a predição da produtividade para uma dose de dejeto aplicado de 35 metros cúbicos por ha.\n\n\n# y predito com x = 35\n(yx35 <- b0 + b1 * 35)\n\n[1] 7.765\n\n\n\nAjuste a regressão no software R utilizando a função lm(). Após, construa um gráfico de dispersão com a reta de predição do modelo.\n\n\nreg <- lm(RG ~ DOSE, data = reg_ex)\n# coeficientes e R2\nsummary(reg)\n\n\nCall:\nlm(formula = RG ~ DOSE, data = reg_ex)\n\nResiduals:\n     1      2      3      4 \n 0.015 -0.165  0.285 -0.135 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept)  6.15500    0.41390  14.871  0.00449 **\nDOSE         0.04600    0.01126   4.083  0.05506 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2519 on 2 degrees of freedom\nMultiple R-squared:  0.8929,    Adjusted R-squared:  0.8394 \nF-statistic: 16.67 on 1 and 2 DF,  p-value: 0.05506\n\n# anova\nanova(reg)\n\nAnalysis of Variance Table\n\nResponse: RG\n          Df Sum Sq Mean Sq F value  Pr(>F)  \nDOSE       1 1.0580 1.05800  16.674 0.05506 .\nResiduals  2 0.1269 0.06345                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nGráfico\n\n\nMostrar código\nlibrary(ggpmisc) # adiciona a equação no gráfico\n\n\nWarning: package 'ggpmisc' was built under R version 4.2.1\n\n\nCarregando pacotes exigidos: ggpp\n\n\n\nAttaching package: 'ggpp'\n\n\nThe following object is masked from 'package:ggplot2':\n\n    annotate\n\n\nMostrar código\np1 <-\n  ggplot(reg_ex, aes(DOSE, RG)) +\n  geom_smooth(se = FALSE, method = \"lm\") +\n  geom_point(size = 4, color = \"blue\") +\n  stat_poly_eq(formula = y ~ x,\n               aes(label = paste(..eq.label.., ..rr.label.., sep = \"~~~~\")),\n               coef.digits = 5) +\n  labs(x = expression(Doses~de~dejeto~(m^3~ha^{-1})),\n       y = expression(Rendimento~de~grãos~(t~ha^{-1})),\n       title = \"Rendimento de grãos em função da dose de dejeto\")\n\np2 <-\n  ggplot(reg_ex, aes(DOSE, RG)) +\n    geom_abline(intercept = b0,\n              slope = b1,\n              color = \"red\") +\n  geom_smooth(se = FALSE, method = \"lm\") +\n  geom_point(size = 4, color = \"blue\") +\n  stat_poly_eq(formula = y ~ x,\n               aes(label = paste(..eq.label.., ..rr.label.., sep = \"~~~~\")),\n               coef.digits = 5) +\n  labs(x = expression(Doses~de~dejeto~(m^3~ha^{-1})),\n       y = expression(Rendimento~de~grãos~(t~ha^{-1})),\n       title = expression(Compreendendo~o~intercept~(beta[0]))) +\n  scale_x_continuous(limits = c(0, 50),\n                     expand = expansion(c(0, 0.05))) +\n  scale_y_continuous(limits = c(6, 9),\n                     breaks = c(6, 6.155, 7, 8, 9)) +\n  theme(panel.grid.minor = element_blank())\n\np1 + p2\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\n\n\n\n\n\nValores preditos\nPara obter os valores preditos, precisamos considerar os parâmetros estimados da regressão linear, substituindo o x pelos valores observados de x. Felizmente, a vetorização proporcionada pelo R, nos facilita este procedimento, bastando realizar o seguinte comando\n\n(pred <- b0 + b1 * x)\n\n[1] 7.075 7.535 7.995 8.455\n\n\nOs valores preditos também podem ser obtidos com a função predict(), informando o modelo ajustado\n\n(pred2 <- predict(reg))\n\n    1     2     3     4 \n7.075 7.535 7.995 8.455 \n\n\n\n\nResiduais\nOs resíduos são obtidos pela diferença entre os valores observados e os preditos pelo modelo ajustado. Para isso, utilizamos o seguinte comando:\n\n(res <- y - pred)\n\n[1]  0.015 -0.165  0.285 -0.135\n\n# o mesmo com a função residuals()\n(res2 <- residuals(reg))\n\n     1      2      3      4 \n 0.015 -0.165  0.285 -0.135 \n\n\nApenas para fins de comprovação, observe que a soma de quadrado do resíduo obtida anteriormente pode ser calculada agora como:\n\n(sqres2 <- sum(res ^ 2))\n\n[1] 0.1269\n\n\nPor fim, é possível mutar o conjunto de dados incluindo os valores preditos e residuais.\n\nmutate(reg_ex,\n       predito = pred,\n       residual = res)\n\n# A tibble: 4 × 4\n   DOSE    RG predito residual\n  <dbl> <dbl>   <dbl>    <dbl>\n1    20  7.09    7.07   0.0150\n2    30  7.37    7.53  -0.165 \n3    40  8.28    7.99   0.285 \n4    50  8.32    8.45  -0.135"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#cálculo-do-coeficiente-de-correlação",
    "href": "FIT5306/FIT5306_11_REG.html#cálculo-do-coeficiente-de-correlação",
    "title": "11. Regressão e correlação",
    "section": "Cálculo do coeficiente de correlação",
    "text": "Cálculo do coeficiente de correlação\nUtilizando o método dos mínimos quadrados, a correlação entre duas variáveis (x e y) é dada por:\n\\[\nr = \\frac{SP_{xy}}{\\sqrt{SQ_x\\times SQ_y}}\n\\]\nAs definições de \\(SP_{xy}\\), \\(SQ_{x}\\) e \\(SQ_{y}\\) foram apresentadas nas Equações Equation 1, Equation 2 e Equation 3, respectivamente.\nA significância da correlação (r) é testada utilizando um teste t com \\(t_{\\alpha(n-2)}\\) graus liberdade. As hipóteses são:\n\\[\n{H_0}:r = 0\n\\]\n\\[\n{H_1}:r \\ne 0\n\\]\nO valor de t calculado é dado por:\n\\[\n{t_0} = r\\sqrt {\\frac{{n - 2}}{{1 - {r^2}}}}\n\\]\nPor fim, compara-se o t calculado com o tabelado ao nível \\(\\alpha\\) de significância de erro (teste bilateral), com n menos dois graus liberdade.\n\\[\n{t_0} > {t_{\\alpha (n - 2)}} = r \\ne 0\n\\]"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#a-função-cor-do-r",
    "href": "FIT5306/FIT5306_11_REG.html#a-função-cor-do-r",
    "title": "11. Regressão e correlação",
    "section": "A função cor() do R",
    "text": "A função cor() do R\nUtilizando a função do R cor() é possível obter o coeficiente de correlação entre duas variáveis, por exemplo, APLA e AIES do seguinte conjunto de dados:\n\nurl <- \"https://bit.ly/df_biostat\"\ndf_mat <- \n  import(url, sheet = \"maize\", setclass = \"tbl\") |> \n  select(APLA:MGRA)\n\n# correlação de pearson (APLA e AIES)\ncor(df_mat$APLA, df_mat$AIES)\n\n[1] 0.8407699\n\n\nUma matriz de correlação também pode ser calculada informando um data frame de variáveis numéricas\n\n# Matriz gráfica de correlação\ncor(df_mat)\n\n          APLA      AIES      CESP      DIES      MGRA\nAPLA 1.0000000 0.8407699 0.2349817 0.4693013 0.5096475\nAIES 0.8407699 1.0000000 0.2080551 0.4588893 0.4649353\nCESP 0.2349817 0.2080551 1.0000000 0.3985263 0.6763286\nDIES 0.4693013 0.4588893 0.3985263 1.0000000 0.7649486\nMGRA 0.5096475 0.4649353 0.6763286 0.7649486 1.0000000\n\n\nUsando a função corr_plot() do pacote metan, é possível obter uma matriz mista (gráfico e número), contendo a distribuição dos pontos e o coeficiente de correlação entre as variáveis.\n\n# Matriz gráfica de correlação\ncorr_plot(df_mat)"
  },
  {
    "objectID": "FIT5306/FIT5306_11_REG.html#exercício-1",
    "href": "FIT5306/FIT5306_11_REG.html#exercício-1",
    "title": "11. Regressão e correlação",
    "section": "Exercício",
    "text": "Exercício\n\nDados\n\nNeste exemplo, serão utilizados dados referentes ao número de grãos (NGRA) e massa de grãos (MGRA) observados em 15 espigas de milho (n = 15).\n\n\nurl <- \"https://bit.ly/df_biostat\"\ncor_ex <- import(url, sheet = \"COR_EXERCICIO\", setclass = \"tbl\")\n\n(x <- cor_ex$NGRA)\n\n [1] 519 522 624 670 518 547 670 546 444 611 557 702 443 430 481\n\n(y <- cor_ex$MGRA)\n\n [1] 173.5 213.5 221.1 261.5 220.1 177.8 250.8 192.0 193.5 255.6 245.9 207.4\n[13] 185.3 166.6 202.4\n\n(n <- length(x))\n\n[1] 15\n\n\n\n\nMétodo dos mínimos quadrados\n\n(xy <- x * y)\n\n [1]  90046.5 111447.0 137966.4 175205.0 114011.8  97256.6 168036.0 104832.0\n [9]  85914.0 156171.6 136966.3 145594.8  82087.9  71638.0  97354.4\n\n(x2 <- x ^ 2)\n\n [1] 269361 272484 389376 448900 268324 299209 448900 298116 197136 373321\n[11] 310249 492804 196249 184900 231361\n\n(y2 <- y ^ 2)\n\n [1] 30102.25 45582.25 48885.21 68382.25 48444.01 31612.84 62900.64 36864.00\n [9] 37442.25 65331.36 60466.81 43014.76 34336.09 27755.56 40965.76\n\n# soma de xy\n(somxy <- sum(xy))\n\n[1] 1774528\n\n# soma de x\n(somx <- sum(x))\n\n[1] 8284\n\n# soma de y\n(somy <- sum(y))\n\n[1] 3167\n\n# soma de x2\n(somx2 <- sum(x2))\n\n[1] 4680690\n\n# soma de y2\n(somy2 <- sum(y2))\n\n[1] 682086\n\n# adiciona as colunas nos dados originais usando mutate()\ncor_ex <-\n  mutate(cor_ex,\n         xy = xy,\n         x2 = x2,\n         y2 = y2)\ndata.frame(cor_ex)\n\n   NGRA  MGRA       xy     x2       y2\n1   519 173.5  90046.5 269361 30102.25\n2   522 213.5 111447.0 272484 45582.25\n3   624 221.1 137966.4 389376 48885.21\n4   670 261.5 175205.0 448900 68382.25\n5   518 220.1 114011.8 268324 48444.01\n6   547 177.8  97256.6 299209 31612.84\n7   670 250.8 168036.0 448900 62900.64\n8   546 192.0 104832.0 298116 36864.00\n9   444 193.5  85914.0 197136 37442.25\n10  611 255.6 156171.6 373321 65331.36\n11  557 245.9 136966.3 310249 60466.81\n12  702 207.4 145594.8 492804 43014.76\n13  443 185.3  82087.9 196249 34336.09\n14  430 166.6  71638.0 184900 27755.56\n15  481 202.4  97354.4 231361 40965.76\n\n# soma de produtos xy\n(sxy <- somxy - (somx * somy / n))\n\n[1] 25499.77\n\n# soma de quadrados de x\n(sx <- somx2 - somx ^ 2 / n)\n\n[1] 105712.9\n\n# soma de quadrados de y\n(sy <- somy2 - somy ^ 2 / n)\n\n[1] 13426.77\n\n# coeficiente de correlaçao\n(r <- sxy / (sqrt(sx * sy)))\n\n[1] 0.6768405\n\n# t calculado\n(tc <- r * sqrt((n - 2) / (1 - r ^ 2)))\n\n[1] 3.315153\n\n# t tabelado (cauda direita) = 2.16\n# como é bicaudal, considera-se 0.05 / 2\nqt(0.025, df = 13, lower.tail = FALSE)\n\n[1] 2.160369\n\n\n\n\nFunção cor e cor.test()\n\n# somente calcula o r\ncor(x, y)\n\n[1] 0.6768405\n\n# computa o r e realiza o teste de hipótese\ncor.test(x, y)\n\n\n    Pearson's product-moment correlation\n\ndata:  x and y\nt = 3.3152, df = 13, p-value = 0.005583\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.2519252 0.8829624\nsample estimates:\n      cor \n0.6768405"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html",
    "href": "RGV410046/RGV410046_00_ABOUT.html",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "",
    "text": "Bem-vindo ao material de apoio da disciplina RGV410046 (Introdução à linguagem R de programação)! Esta página contém os dados e scripts R necessários para aplicação prática dos conteúdos vistos na disciplina."
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1150",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1150",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "21/11/2022 (08:20 às 11:50)",
    "text": "21/11/2022 (08:20 às 11:50)\n\nIntrodução à disciplina\nInstalação do R e Rstudio\nIntrodução ao R\n\nScript\nBásico de funções\nPacotes\nFóruns e materiais de apoio\n\nExercício (encontrar pacotes)"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1600",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1600",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "23/11/2022 (13:30 às 16:00)",
    "text": "23/11/2022 (13:30 às 16:00)\n\nDinâmica aula anterior\nTipos de dados\n\nNumérico\nLógico\nCaractere\n\nEstrutura de dados;\n\nVetor\nMatriz\nData frame\nTibbles\nArray\n\nLógica de programação\n\nBase\nTidyverse\n\nExercício (lógica de programação)"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1600-1",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1600-1",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "24/11/2022 (13:30 às 16:00)",
    "text": "24/11/2022 (13:30 às 16:00)\n\nImportação de dados (pc, repositório)\ndados tidy\nConversão de dados\nExercício descrição dos dados, arrumar tipo de dados\nExportação de dados"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1600-2",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1600-2",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "25/11/2022 (13:30 às 16:00)",
    "text": "25/11/2022 (13:30 às 16:00)\n\nMutação de dados\n\nselect\nfilter\narrange\nmutate\ngroup_by\n\n(dados próprios para o dia 1)"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1150-1",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1150-1",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "28/11/2022 (08:20 às 11:50)",
    "text": "28/11/2022 (08:20 às 11:50)\n\nSintetização de dados\n\nsummarise\nacross"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1600-3",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1600-3",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "30/11/2022 (13:30 às 16:00)",
    "text": "30/11/2022 (13:30 às 16:00)\n\nManipulação de dados\n\nLonger (dados errados, para arrumar)\nWider\nrename\nSeparate\nUnite"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1600-4",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1600-4",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "01/12/2022 (13:30 às 16:00)",
    "text": "01/12/2022 (13:30 às 16:00)\n\nSeus dados, suas análises"
  },
  {
    "objectID": "RGV410046/RGV410046_00_ABOUT.html#às-1500",
    "href": "RGV410046/RGV410046_00_ABOUT.html#às-1500",
    "title": "RGV410046 - Introdução à linguagem R de programação",
    "section": "02/12/2022 (13:30 às 15:00)",
    "text": "02/12/2022 (13:30 às 15:00)\n\no básico do ggplot2\nFechamento da disciplina"
  },
  {
    "objectID": "00_about.html",
    "href": "00_about.html",
    "title": "Material de apoio à disciplinas",
    "section": "",
    "text": "Esta página contém os materiais de apoio em linguagem R das disciplinas ministradas pelo Prof. Tiago Olivoto no Departamento de Fitotecnia do Centro de Ciências Agrárias da Universidade Federal de Santa Catarina\n\nInstalação dos softwares\nPara reprodução dos exemplos deste material, os softwares R e RStudio são necessários\n\n\n Download do R\n Download do RStudio\n\n\nProfessor\n\n\n\n\n\n\nNote\n\n\n\nTécnico Agrícola pela Escola Estadual de Educação Básica Viadutos (2008), Engenheiro agrônomo pela Universidade do Oeste de Santa Catarina (2014), Mestre em Agronomia: Agricultura e Ambiente pela Universidade Federal de Santa Maria (2017) e Doutor em Agronomia com ênfase em Melhoramento Genético Vegetal e Experimentação Agrícola pela Universidade Federal de Santa Maria (2020). Atualmente é Professor Adjunto A1 do Departamento de Fitotecnia da Universidade Federal de Santa Catarina (UFSC), atuando na área de Melhoramento Genético Vegetal e Experimentação Agrícola. Exerce atividades relacionadas ao planejamento, condução e avaliação de experimentos com culturas anuais, com ênfase no desenvolvimento e aperfeiçoamento de métodos estatístico-experimentais para avaliação de ensaios multi-ambientes em melhoramento genético de plantas. Em seu Currículo, os termos mais frequentes na contextualização da produção científica são: análise de ensaios multi-ambientes, índices multivariados, intervalo de confiança para correlação, planejamento de experimentos, seleção indireta, interação genótipo-vs-ambiente, modelos mistos e parâmetros genéticos. É membro atuante da International Biometric Society (IBS) e integrante da comissão de Jovens Pesquisadores da Região Brasileira da Sociedade Internacional de Biometria, RBras, (JP-RBras) representando os estados do RS, SC e PR. Atua também como revisor ad hoc em revistas científicas nacionais e internacionais. Tem experiência com os softwares Gênes, GEA-R, R, SAS e SPSS. Vem desenvolvendo os pacotes para software R metan, voltado para a checagem, manipulação, análise e apresentação de dados de ensaios multi-ambientes e pliman voltado para a análise de imagens de plantas.\n\n\n\n\n\n\n\n\n\nPacotes úteis\nPara reprodução dos exemplos deste repositório é sugerido instalar os seguintes pacotes. Para saber como instalar pacotes no R, visite este vídeo!\n\nlibrary(tidyverse)  # manipulação de dados\nlibrary(metan)      # estatísticas descritivas/gráficos\nlibrary(rio)        # importação/exportação de dados\nlibrary(emmeans)    # comparação de médias\nlibrary(AgroR)      # casualização e ANOVA\n\n\n\nLicença\nEste conteúdo está licenciado com uma Licença Creative Commons - Atribuição-NãoComercial-CompartilhaIgual 4.0 Internacional. O resumo legível da licença afirma que você tem o direito de:\n\nCompartilhar — copie e redistribua o material em qualquer meio ou formato.\nAdaptar — remixar, transformar e construir sobre o material\nAtribuir — Você deve dar o crédito apropriado, fornecer um link para a licença e indicar se foram feitas alterações. Você deve fazê-lo sob quaisquer circunstâncias razoáveis, mas de forma alguma sugerindo que o licenciante endossa você ou seu uso.\n\nEsta licença e válida sob os seguintes termos:\n\nNão comercial (NC) — Você não pode usar o material para fins comerciais.\nShare Alike (SA) — Se você remixar, transformar ou desenvolver o material, deverá distribuir suas contribuições sob a mesma licença do original.\nSem restrições adicionais — Você não pode aplicar termos legais ou medidas tecnológicas que restrinjam legalmente outras pessoas de fazer qualquer coisa que a licença permita.\n\n\n\nSelo DC\n\nO selo selo Democratizando Conhecimento (DC) é uma ideia criada pelo Prof. Ben Dêivid. O selo é compatível com a licença Creative Commons CC BY NC SA 4.0 e é utilizado aqui para garantir que o acesso de todo esse material seja livre, gratuíto e de código aberto. Meu principal objetivo com isso é democratizar o uso e aplicação do R nas Ciências Agrárias.\n\n\nVisite-nos!"
  },
  {
    "objectID": "FIT5306/FIT5306_00_ABOUT.html",
    "href": "FIT5306/FIT5306_00_ABOUT.html",
    "title": "FIT5306 - Bioestatística e Experimentação Agrícola",
    "section": "",
    "text": "Bem-vindo ao material de apoio da disciplina FIT5306 (Bioestatística e Experimentação Agrícola)! Esta página contém os dados e scripts R necessários para aplicação prática dos conteúdos vistos na disciplina."
  },
  {
    "objectID": "FIT5306/FIT5306_00_ABOUT.html#regressão",
    "href": "FIT5306/FIT5306_00_ABOUT.html#regressão",
    "title": "FIT5306 - Bioestatística e Experimentação Agrícola",
    "section": "Regressão",
    "text": "Regressão\n\nREG_DATA: dados sem repetição (hipotéticos) do RG observados em diferentes doses de Nitrogênio.\nREG_ANALISE: Análise de regressão linear de primeiro grau dos dados REG_DATA.\nREG_DEL_DATA: dados com repetições do rendimento de grãos observados em diferentes doses de Nitrogênio.\nREG_DEL_ANALISE: Análise de regressão dos dados REG_DEL_DATA.\nREG_PRATICA: dados referente a uma amostra de tamanho n = 11, na qual se aplicou CO2 em diferentes concentrações em folhas de trigo (X). A quantidade de C02 absorvida (Y) em cm3 / dm2 / hora foi avaliada. Esse exemplo foi apresentado por Ferreira (2009)[^1].\nREG_PRATICA_ANALISE: Análise de regressão dos dados REG_PRATICA."
  },
  {
    "objectID": "FIT5306/FIT5306_00_ABOUT.html#correlação",
    "href": "FIT5306/FIT5306_00_ABOUT.html#correlação",
    "title": "FIT5306 - Bioestatística e Experimentação Agrícola",
    "section": "Correlação",
    "text": "Correlação\n\nCOR_DATA_DENSIDADE: Dois métodos de mensurar a densidade média da madeira (g /cm\\(^3\\)) em Eucalyptus grandis foram aplicados a uma amostra de n = 13 árvores. O primeiro método (X) é determinado utilizando um paquímetro e uma sonda Pressler de 0,5 cm na região da árvore determinada no diâmetro à altura do peito (DAP). A segunda, variável (Y) também foi mensurada no DAP utilizando cortes transversais no tronco. Esse exemplo foi apresentado por Ferreira (2009)[^1].\nCORRELACAO_DATA: dados de altura de planta (AP) e altura da espiga (AE) observados em 10 plantas de milho.\nCORRELACAO_ANALISE: Análise de correlação para os dados CORRELACAO_DATA."
  },
  {
    "objectID": "FIT5306/FIT5306_00_ABOUT.html#experimentos-unifatoriais",
    "href": "FIT5306/FIT5306_00_ABOUT.html#experimentos-unifatoriais",
    "title": "FIT5306 - Bioestatística e Experimentação Agrícola",
    "section": "Experimentos unifatoriais",
    "text": "Experimentos unifatoriais\n\n\n\n\n\n\nNote\n\n\n\nOs dados COBERTURA_N_MASSA e COBERTURA_N_SOJA foram obtidos em um trabalho conduzido em grupo no Centro Universitário Unideau, tendo como participantes os alunos Bernardo Pinheiro Busatta, Tiago Jonatan Fochesatto, Diogo Andre Ody, Gustavo Peretti e Paulo Sérgio Trevisol.\n\n\n\nCOBERTURA_N_MASSA: dados de um experimento bifatorial com dois níveis de nitrogênio (com e sem) e quatro níveis de plantas de cobertura (aveia preta, centeio, triticale e pousio), conduzido em um DBC com quatro repetições. Foram avaliados a matéria verde (MV) e matéria seca (MS) das plantas, bem como a matéria seca de raiz (MSR).\nCOBERTURA_N_SOJA: Com os mesmos tratamentos apresentados em COBERTURA_N_MASSA, o experimento avaliou caracteres morfológicos e o rendimento de grãos de soja cultivada na resteva das respectivas coberturas de solo. Foram avaliados o número de legumes por planta (NL), número de grãos por legume (NGL), massa de mil grãos (MMG) e o rendimento de grãos (RG).\nDIC-DBC: dados de área foliar (AF) e matéria seca de planta (MST) de plantas de chicória avaliadas em diferentes níveis de radiação solar (50%, 70% e 100%). O experimento foi conduzido em delineamento de blocos completos casualizados, com quatro repetições.\nEFEITOS: Os efeitos de tratamento e erro (delineamento inteiramente casualizado) para os dados da planilha DIC-DBC.\nDIC-DBC-ANOVA: análise de variância nos delineamentos DIC e DBC, para efeitos de comparação, dos dados da planilha DIC-DBC.\nQUALI: Dados do rendimento de grãos (RG) de 10 híbridos de milho avaliados em um delineamento de blocos completos casualizados, com quatro repetições.\nQUANTI_LINEAR: Dados do rendimento de grãos (RG) de um híbrido de milho sob diferentes doses de nitrogênio, avaliados em um delineamento de blocos completos casualizados, com quatro repetições. O conjunto apresenta um comportamento linear.\nQUANTI_LINEAR: Dados do rendimento de grãos (RG) de um híbrido de milho sob diferentes doses de nitrogênio, avaliados em um delineamento de blocos completos casualizados, com quatro repetições. O conjunto apresenta um comportamento linear.\nQUANTI_QUADRÁTICA: Dados do rendimento de grãos (RG) de um híbrido de milho sob diferentes doses de nitrogênio, avaliados em um delineamento de blocos completos casualizados, com quatro repetições. O conjunto apresenta um comportamento quadrático.\nmaize: Dados de um ensaio multi-ambientes onde 13 híbridos de milho foram avaliados em quatro localidades, sendo que em cada localidade um delineamento de blocos completos casualizados com três repetições foi utilizado. São apresentados dados de sete caracteres quantitativos avaliados em cinco plantas aleatoriamente escolhidas em cada parcela."
  },
  {
    "objectID": "FIT5306/FIT5306_00_ABOUT.html#experimentos-bifatoriais",
    "href": "FIT5306/FIT5306_00_ABOUT.html#experimentos-bifatoriais",
    "title": "FIT5306 - Bioestatística e Experimentação Agrícola",
    "section": "Experimentos bifatoriais",
    "text": "Experimentos bifatoriais\nAs seguintes planilhas contém dados de experimentos bifatoriais com diferentes combinações de fatores qualitativos e quantitativos na presença de interação significativa e não significativa. Em todos os exemplos, é utilizado o delineamento de blocos completos casualizados.\n\nFAT1_SI: Fator 1 qualitativo (fontes de nitrogênio), com três níveis; Fator 2 qualitativo (híbridos), com três níveis, com interação significativa.\nFAT1_CI: Fator 1 qualitativo (dias de avaliação), com três níveis; Fator 2 qualitativo (radiação solar), com três níveis, sem interação significativa.\nFAT1_C2I1: Fator 1 Qualitativo (enxofre), com dois níveis; Fator 2 qualitativo (parcelamento de N), com três níveis, com interação significativa.\nFAT2_SI: Fator 1 qualitativo (híbridos), com dois níveis; Fator 2 quantitativo (doses de N), com cinco níveis, sem interação significativa.\nFAT2_CI: Fator 1 qualitativo (híbridos), com dois níveis; Fator 2 quantitativo (doses de N), com cinco níveis, com interação significativa.\nFAT3: Fator 1 quantitativo (doses de N), com quatro níveis; Fator 2 quantitativo (doses de K), com cinco níveis, com interação significativa."
  }
]